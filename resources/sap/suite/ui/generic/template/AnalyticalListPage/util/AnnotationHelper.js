(function(){"use strict";jQuery.sap.require("sap.ui.comp.smartfield.SmartField");jQuery.sap.require("sap.suite.ui.generic.template.extensionAPI.UIMode");jQuery.sap.require("sap/ui/model/Context");sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper={getDetailEntitySet:function(c){var o=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(M.getODataEntitySet(o,true));},resolveMetaModelPath:function(c){var p=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(p);},createWorkingContext:function(c){var p=c.getObject(),s=p.settings,m=c.getModel(),M=m.getProperty("/metaModel"),E=M.getODataEntitySet(p.entitySet),o=M.getODataEntityType(E.entityType),a="",w={};a=o.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");w.selectionPresentationVariant=M.getObject(a);w.selectionPresentationVariantQualifier=a.split("#")[1]||"";w.selectionPresentationVariantPath=a;if(s.tableType==="TreeTable"&&o&&o.hasOwnProperty('property')&&o.property.length){var I=[],h="",P=o.property;for(var i=0;i<P.length;i++){if(P[i].hasOwnProperty('sap:hierarchy-node-for')){h=P[i]["sap:hierarchy-node-for"];break;}}for(var i=0;i<P.length;i++){var b=P[i].name!==s.uniqueHierarchyNodeIDForTreeTable&&P[i].name!==h;if(!P[i].hasOwnProperty('com.sap.vocabularies.Analytics.v1.Measure')){if(P[i].hasOwnProperty('sap:attribute-for')&&b){if(P[i]['sap:attribute-for']!==s.uniqueHierarchyNodeIDForTreeTable&&P[i]['sap:attribute-for']!==h){I.push(P[i]['name']);}}else if(b){I.push(P[i]['name']);}}}w.ignoredFields=I.toString();}if(w.selectionPresentationVariant&&w.selectionPresentationVariant.PresentationVariant){a=w.selectionPresentationVariant.PresentationVariant.Path||w.selectionPresentationVariant.PresentationVariant.AnnotationPath||w.selectionPresentationVariantPath+"/PresentationVariant";if(a.indexOf("@")===0){a=o.$path+"/"+a.substr(1);}}else{a=o.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");}if(typeof a==="string"){w.presentationVariant=M.getObject(a);w.presentationVariantPath=a;w.presentationVariantQualifier=a.split("#")[1]||"";w.initialExpansionLevel=w.presentationVariant&&w.presentationVariant.InitialExpansionLevel&&w.presentationVariant.InitialExpansionLevel.Int;}if(s.qualifier&&!w.presentationVariant){var e=new Error("Error in manifest.json: Not SelectionPresentationVariant or PresentationVariant found for qualifier: "+s.qualifier,"./manifest.json");throw e;}if(w.presentationVariant&&w.presentationVariant.Visualizations){w.presentationVariant.Visualizations.forEach(function(v){var f="/"+v.AnnotationPath.slice(1);if(f.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a=o.$path+f;w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier=a.split("#")[1]||"";w.lineItemCriticality=sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper._resolveLineItemCriticality(w.lineItem,w.lineItemQualifier);}if(!s.chartPresentationQualifier&&(f.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1)){a=o.$path+f;w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier=a.split("#")[1]||"";}});}if(!w.lineItem){a=o.$path+"/com.sap.vocabularies.UI.v1.LineItem";w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier="";w.lineItemCriticality=sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper._resolveLineItemCriticality(w.lineItem,w.lineItemQualifier);}if(s&&s.chartPresentationQualifier){var d=o.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant"+"#"+s.chartPresentationQualifier;var C=M.getObject(d);if(!C){var e=new Error("Error in manifest.json: No PresentationVariant found for qualifier: "+s.chartPresentationQualifier,"./manifest.json");throw e;}if(C&&!C.Visualizations){var e=new Error("Error: No Visualizations found in PresentationVariant for chartPresentationVariantQualifier: "+s.chartPresentationQualifier,"./manifest.json");throw e;}else{C.Visualizations.forEach(function(v){var f="/"+v.AnnotationPath.slice(1);if(f.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){a=o.$path+f;w.chart=M.getObject(a);w.chartPath=a;w.chartPresentationVariantQualifier=s.chartPresentationQualifier;w.chartQualifier=a.split("#")[1]||"";}});if(!w.chart){var e=new Error("Error: No chart annotations found with chartPresentationVariantQualifier "+s.chartPresentationQualifier,"./manifest.json");throw e;}}}if(!s.chartPresentationQualifier&&!w.chart){a=o.$path+"/com.sap.vocabularies.UI.v1.Chart";w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier="";}m.setProperty("/workingContext",w);return"/workingContext";},hasDeterminingActionsForALP:function(t,c,e,m){if(e&&m&&m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]&&sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper._hasCustomDeterminingActionsInALP(e,m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"])){return true;}for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&t[r].Determining&&t[r].Determining.Bool==="true"){return true;}}for(var r=0;r<c.length;r++){if((c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&c[r].Determining&&c[r].Determining.Bool==="true"){return true;}}return false;},_hasCustomDeterminingActionsInALP:function(e,m){if(m&&m[e]){var M=m[e];if(M.Actions){for(var a in M.Actions){if(M.Actions[a].determining){return true;}}}}return false;},getFilterableKPIs:function(k){var m=k.getModel();var a={};var K=k.getObject();a.filterableKPIs=[];a.globalKPIs=[];if(K){for(var i=0;i<Object.keys(K).length;i++){if(K[Object.keys(K)[i]]["filterable"]){a.filterableKPIs.push(K[Object.keys(K)[i]]);}else{a.globalKPIs.push(K[Object.keys(K)[i]]);}}}m.setProperty("/kpiContext",a);return"/kpiContext";},generateKPIToolbarId:function(k){for(var i=0;Object.keys(k).length;i++){if(k[Object.keys(k)[i]]["filterable"]){return"template::KPITagContainer::filterableKPIs";}else{return"template::KPITagContainer::globalKPIs";}}},generateKPITagID:function(k){return"template::KPITag::"+k.model+"::"+k.qualifier;},_resolveLineItemCriticality:function(l,a){if(l){var c;if(a){c=l["com.sap.vocabularies.UI.v1.Criticality#"+a];}else{c=l["com.sap.vocabularies.UI.v1.Criticality"];}if(!c){return"";}else{return c.Path?"\\{\"Path\": \""+c.Path+"\"\\}":"\\{\"EnumMember\": \""+c.EnumMember+"\"\\}";}}else{jQuery.sap.log.error("Please add LineItem annotation for your application");return undefined;}}};sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper.getDetailEntitySet.requiresIContext=true;})();
