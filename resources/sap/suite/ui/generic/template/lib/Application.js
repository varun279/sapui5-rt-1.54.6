sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/StatePreserver","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,C,S,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",h="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(h)){return"";}else{return T?s:h;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;function h(){return l;}function s(i){l=i;}function k(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function m(i){T.fnAddSideEffectPromise(i);}function p(i){if(I){return;}var j=q.grep(T.aRunningSideEffectExecutions,function(m1){return!!m1;});if(j.length){I=true;Promise.all(j).then(function(){I=false;p(i);});}else{i();}}function n(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var m1=i[j];i[j]=function(){var n1=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){m1.apply(i,n1);});}});};}}var F={};function u(i,j,m1,n1,o1){i=i||T.oNavigationHost;var p1=i.getId();var q1=F[p1]||(F[p1]={});var r1=q1[j];if(!r1){r1=sap.ui.xmlfragment(p1,j,m1);f(r1,i);var s1;if(n1){s1=new J();r1.setModel(s1,n1);}(o1||q.noop)(r1,s1);q1[j]=r1;n(r1);}return r1;}function v(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function w(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function x(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var y=false;function z(i){y=i;}function G(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var m1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(m1);}function R(i){T.aStateChangers.push(i);}function K(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function L(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function N(i,j,m1){var n1=T.mEntityTree[i];var o1;if(n1.navigationProperty&&n1.parent){o1=j?n1.entitySet:n1.navigationProperty;}else{o1=i;}if(m1.indexOf(o1)<0){m1.unshift(o1);if(n1.navigationProperty&&n1.parent){N(n1.parent,j,m1);}}}function O(i,j){var m1=[];N(i,j,m1);return m1;}function Q(j){var m1=O(j);m1.pop();var n1="";var o1="";var p1=[];for(var i=0;i<m1.length;i++){n1=n1+o1+m1[i];p1.push(n1);o1="/";}return p1;}function U(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var m1=j.split("/");if(m1[0]===""||m1[0]==="#"){m1.splice(0,1);}return m1;}function V(i,j,m1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,m1);}return i;}function W(){var j=T.oNavigationControllerProxy.getActiveComponents();var m1=0;var n1;for(var i=0;i<j.length;i++){var o1=T.componentRegistry[j[i]];if(o1.viewLevel>0&&(m1===0||o1.viewLevel<m1)){m1=o1.viewLevel;n1=o1.oComponent;}}var p1=n1?Promise.resolve(n1):T.oNavigationControllerProxy.getRootComponentPromise();return p1.then(function(q1){return q1.getModel("i18n").getResourceBundle();});}function X(){return T.oNavigationControllerProxy.getAppTitle();}function Y(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function Z(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function $(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(k(j.oComponent)){var m1=j.oComponent.getComponentContainer().getElementBinding();return m1&&m1.getPath();}else{return null;}}}return null;}function _(m1,n1,o1,p1,q1){var r1=o1.oComponent.getEntitySet();var s1=T.mEntityTree[r1];var t1=false;var u1;var v1=true;for(var i=0;i<s1.children.length&&!u1;i++){var w1=s1.children[i];var x1=T.mEntityTree[w1];if(x1.navigationProperty===m1){u1=x1.sRouteName;v1=!x1.noKey;}}if(p1&&!u1){var y1=s1.embeddedComponents[p1];if(y1){for(var j=0;j<y1.pages.length&&!t1;j++){var z1=y1.pages[j];if(z1.navigationProperty===m1){t1=true;u1=r1+"/"+p1+"/"+m1;v1=!(z1.routingSpec&&z1.routingSpec.noKey);}}}}if(u1){var A1=t1?p1+r.getPatternDelimiter():"";var B1=v1?"("+n1+")":"";var C1=A1+m1+B1;T.oNavigationControllerProxy.navigateToSuffix(C1,o1.viewLevel+1,u1,q1);}}var a1;function b1(i){var j=i.getEntitySet();var m1=T.mEntityTree[j];if(m1&&m1.communicationModel){return m1.communicationModel;}a1=a1||new J();return a1;}var c1;function d1(j,m1){var i=m1||0;if(i>0){return null;}var n1=j.getEntitySet();var o1=T.mEntityTree[n1];var p1=o1&&o1.communicationObject;for(;i<0&&p1;){o1=T.mEntityTree[o1.parent];if(o1.communicationObject!==p1){i++;p1=o1.communicationObject;}}if(i<0||p1){return p1;}c1=c1||{};return c1;}function e1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function f1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function g1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var m1=j[i];var n1=T.componentRegistry[m1];var o1=n1.methods.currentDraftModified&&n1.methods.currentDraftModified();if(o1){o.markDraftAsModified(o1);}}}function h1(){if(E!==undefined){return E;}var i,j,m1,n1,o1,p1,q1=true;var r1=T.oAppComponent.getModel();var s1=r1.getMetaModel();var t1=r1.mContexts;for(m1 in t1){q1=false;o1=t1[m1].sPath;n1=o1&&o1.substring(1,o1.indexOf('('));p1=n1&&s1.getODataEntitySet(n1);if(p1){i=r1.getProperty(o1);j=i&&r1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(q1){return true;}E=false;return E;}function i1(j){var i,m1,n1;var o1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<o1.length;i++){m1=o1[i];if(!j||!j[m1]){n1=T.componentRegistry[m1];n1.utils.refreshBinding(true);}}}function j1(i){if(T.oFlexibleColumnLayoutHandler){T.oFlexibleColumnLayoutHandler.setStoredTargetLayoutToFullscreen(i);}}function k1(){T.oPaginatorInfo={};}function l1(i){return new S(T,i);}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,areTwoKnownPathesIdentical:o.areTwoKnownPathesIdentical,getResourceBundleForEditPromise:W,getHierarchySectionsFromCurrentHash:U,getContentDensityClass:g,setEditableNDC:z,getDialogFragment:u.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:s,markCurrentDraftAsModified:g1,prepareDeletion:L};return{setEditableNDC:z,getEditableNDC:function(){return y;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:u,getBusyHelper:function(){return T.oBusyHelper;},addSideEffectPromise:m,performAfterSideEffectExecution:p,isComponentActive:k,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([v(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:w,getFclProxyForView:x,isNewHistoryEntryRequired:G,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:K,getBreadCrumbInfo:Q,adaptBreadCrumbUrl:V,getSections:O,getHierarchySectionsFromCurrentHash:U,getAppTitle:X,subTitleForViewLevelChanged:Y,getCurrentKeys:Z,getPathForViewLevelOneIfVisible:$,getCommunicationModel:b1,getCommunicationObject:d1,navigateRoute:_,getForwardNavigationProperty:e1,getMaxColumnCountInFCL:f1,getListReportTable:h,markCurrentDraftAsModified:g1,checkEtags:h1,refreshAllComponents:i1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T),setStoredTargetLayoutToFullscreen:j1,invalidatePaginatorInfo:k1,getStatePreserver:l1};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});
