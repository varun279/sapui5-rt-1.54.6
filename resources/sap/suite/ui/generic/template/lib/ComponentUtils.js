sap.ui.define(["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";var C={};function g(c,o){var h;var H;var a;var b;var I=false;var d=[];var e=[];function f(i){var h1;var i1=c.getModel();if(i){if(i1){h1=i1.getProperty(i);}}else{var j1=c.getBindingContext();if(j1){h1=j1.getObject();}}return!!(h1&&h1.__metadata&&h1.__metadata.created);}function j(){return c.getModel("_templPriv");}function k(){return j().getProperty("/generic/viewLevel");}function l(){return o.preprocessorsData;}function m(){return o.oParameterModel;}function n(){var i=c.getModel("i18n").getResourceBundle();return{dataLoadFailedTitle:i.getText("ST_ERROR"),dataLoadFailedText:i.getText("ST_GENERIC_ERROR_LOAD_DATA_TEXT")};}function A(i,h1,i1){if(typeof i1!=="function"){throw new Error("Event handler must be a function");}e.push({template:i,event:h1,handler:i1});}function D(h1,i1,j1){for(var i=e.length;i--;){if(e[i].handler===j1&&e[i].event===i1&&e[i].template===h1){e.splice(i,1);}}}function F(h1,i1,j1){for(var i=0;i<e.length;i++){if(e[i].event===i1&&e[i].template===h1){e[i].handler(j1);}}}function p(i){return i.getMetadata().getName();}function r(){return o.oApplication.isComponentActive(c);}function s(){return o.oNavigationObserver.getProcessFinished(true);}function P(i,h1){var i1=s();i1.then(function(){if(r()){if(h1){J(true);}F(p(o.oController),"PageDataLoaded",{context:i});}});}function t(){h.then(function(i){if(i){P(i);}});}function S(){o.oHeaderLoadingObserver.startProcess();if(!b){var i=new Promise(function(h1){b=h1;});o.oApplication.getBusyHelper().setBusy(i);}}function N(){if(!H){h=new Promise(function(i){H=i;});}}N();function u(){I=true;N();if(!c.getComponentContainer().getElementBinding().isSuspended()){S();}}function E(){if(b){b();b=null;}o.oHeaderLoadingObserver.stopProcess();}function v(i){var h1=i.getSource().getBoundContext();if(h1){return h1;}if(c.getComponentContainer().getElementBinding().isSuspended()){h1=null;}else{h1=C;}U();E();return h1;}function w(){var i=n();var h1=c.getAppComponent().getNavigationController();h1.navigateToMessagePage({title:i.dataLoadFailedTitle,text:i.dataLoadFailedText,description:"",viewLevel:k()});}function x(){I=false;if(!a){return;}if(a===C){w();}else if(!c.getComponentContainer().getElementBinding().isSuspended()){(o.methods.updateBindingContext||q.noop)();if(H){H(a);}}else{return;}H=null;a=null;}function y(i){E();if(I){a=v(i);}x();}function z(i){a=v(i);x();o.oHeaderLoadingObserver.stopProcess();}function R(i){var h1={};var i1=l();if(i1.rootContextExpand&&i1.rootContextExpand.length){h1.expand=i1.rootContextExpand.join(",");}o.oHeaderLoadingObserver.startProcess();if(o.methods.beforeRebind){o.methods.beforeRebind();}N();a=null;c.getComponentContainer().bindElement({path:i,events:{dataRequested:u,dataReceived:y,change:z},parameters:h1,batchGroupId:"Changes",changeSetId:"Changes"});if(o.methods.afterRebind){o.methods.afterRebind();}}function U(){N();var i=c.getComponentContainer();i.unbindElement();a=null;}function G(){var h1=W();var i1=(h1.length===d.length);for(var i=0;i<h1.length&&i1;i++){i1=h1[i]===d[i];}d=h1;return!i1;}function J(i){var h1=o.reuseComponentProxies;for(var i1 in h1){h1[i1].pathUnchangedCallBack(i);}}function K(i){var h1=Object.create(null);var i1=o.reuseComponentProxies;for(var j1 in i1){var k1=i1[j1];h1[j1]=i(k1,j1);}return h1;}function L(i,h1){var i1=G();if(!i){if(o.routingSpec&&o.routingSpec.noOData){P(null,i1);}return;}var j1=c.getComponentContainer();if(!j1){return;}if(f(i)){U();var k1=j1.getModel().getContext(i);if(H){H(k1);H=null;}else{h=Promise.resolve(k1);}j1.setBindingContext(k1);Promise.all([o.oViewRenderedPromise,o.viewRegisterd]).then(J.bind(null,true));}else{var l1=j1.getElementBinding();if(l1){if(l1.getPath()===i){if(l1.isSuspended()){l1.resume();x();}if(I){S();}o.oApplication.getBusyHelper().getUnbusy().then(J.bind(null,i1&&o.routingSpec.noOData));if(!h1){t();}return;}else if(!h1){U();}}var m1=c.getModel("ui");m1.setProperty("/enabled",false);m1.setProperty("/editable",false);R(i);t();}}function M(i){i=i||c.getIsRefreshRequired();if(i||!q.isEmptyObject(o.oGenericData.mRefreshInfos)){(o.methods.refreshBinding||q.noop)(i,o.oGenericData.mRefreshInfos);c.setIsRefreshRequired(false);o.oGenericData.mRefreshInfos={};}J(i);}function O(){var i=c.getComponentContainer();var h1=i.getBindingContext();var i1=h1&&h1.getPath();var j1=i1&&f(i1);if(j1){i.setBindingContext();return;}var k1=i.getElementBinding();if(k1&&!k1.isSuspended()){if(o.oTemplateContract.oValidationMessageBinding.getLength()){U();}else{k1.suspend();}E();}}function Q(i){o.oApplication.setBackNavigation(i);}function T(i){var h1=k();return o.oApplication.registerContext(i,h1,c.getEntitySet());}function V(){return o.oApplication.getBreadCrumbInfo(c.getEntitySet());}function W(){return o.oApplication.getCurrentKeys(k());}function X(){return o.oApplication.getCommunicationModel(c);}function Y(i){return o.oApplication.getCommunicationObject(c,i);}function Z(i,h1,i1,j1){o.oApplication.navigateRoute(i,h1,o,i1,j1);}function $(){var i=c.getEntitySet();var h1=o.oTemplateContract.mEntityTree[i];return h1.headerTitle;}function _(){var i=c.getEntitySet();var h1=o.oTemplateContract.mEntityTree[i];return h1.isDraft;}function a1(){if(_()){var i=o.oApplication.getHierarchySectionsFromCurrentHash();return"/"+i[0];}}function b1(){return!(o.routingSpec&&o.routingSpec.noOData);}function c1(){return h;}function d1(){return o.oTemplateContract.oPaginatorInfo[k()-1];}function e1(i,h1){var i1=k();if(!h1){i1--;}o.oTemplateContract.oPaginatorInfo[i1]=i;}function f1(i,h1){var i1=h1.getId();var j1=i1.split("::");var k1=j1[j1.length-2];var l1=j();l1.setProperty("/generic/embeddedComponents/"+k1+"/isInVisibleArea",i);}function g1(i){var h1={appStateName:encodeURI("sap-iapp-state-"+o.routeConfig.entitySet),getCurrentState:function(){var i1=i.getCurrentState?i.getCurrentState():Object.create(null);var j1=function(k1,l1){if(k1.component.stGetCurrentState){var m1=k1.component.stGetCurrentState();for(var n1 in m1){i1["$embeddedComponent$"+l1.length+"$"+l1+"$"+n1]=m1[n1];}}};K(j1);return i1;},applyState:function(i1,j1){var k1=Object.create(null);var l1=Object.create(null);for(var m1 in i1){if(m1.indexOf("$embeddedComponent$")===0){var n1=m1.substring(19);var o1=n1.indexOf("$");var p1=Number(n1.substring(0,o1));var q1=n1.substring(o1+1,o1+p1+1);var r1=l1[q1];if(!r1){r1=Object.create(null);l1[q1]=r1;}var s1=n1.substring(o1+p1+2);r1[s1]=i1[m1];}else{k1[m1]=i1[m1];}}(i.applyState||q.noop)(k1,j1);var t1=function(u1,v1){if(u1.component.stApplyState){u1.component.stApplyState(l1[v1]||Object.create(null),j1);}};o.oViewRenderedPromise.then(K.bind(null,t1));},oComponent:c};i.oStatePreserver=o.oApplication.getStatePreserver(h1);o.oApplication.registerStateChanger(i.oStatePreserver.getAsStateChanger());}return{setEditableNDC:function(i){o.oApplication.setEditableNDC(i);},getEditableNDC:function(){return o.oApplication.getEditableNDC();},getBusyHelper:function(){return o.oApplication.getBusyHelper();},isNonDraftCreate:f,attach:function(i,h1,i1){A(p(i),h1,i1);},detach:function(i,h1,i1){D(p(i),h1,i1);},fire:function(i,h1,i1){F(p(i),h1,i1);},isListReportTemplate:function(){return sap.suite.ui.generic.template.js.AnnotationHelper.isListReportTemplate(o.routeConfig);},getPreprocessorsData:l,getParameterModelForTemplating:m,bindComponent:L,refreshBinding:M,suspendBinding:O,setBackNavigation:Q,getTemplatePrivateModel:j,registerContext:T,getViewLevel:k,getBreadCrumbInfo:V,getCurrentKeys:W,getDraftRootPath:a1,getCommunicationModel:X,getCommunicationObject:Y,navigateRoute:Z,getTitleFromTreeNode:$,isDraftEnabled:_,isODataBased:b1,isComponentActive:r,navigateToDataLoadedFailedPage:w,getHeaderDataAvailablePromise:c1,getPaginatorInfo:d1,setPaginatorInfo:e1,onVisibilityChangeOfReuseComponent:f1,getNavigationFinishedPromise:s,setStatePreserver:g1};}return B.extend("sap.suite.ui.generic.template.lib.ComponentUtils",{constructor:function(c,o){q.extend(this,g(c,o));}});});
