sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/Select","sap/m/MessageBox","sap/m/MessageToast","sap/m/Table","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/model/odata/type/Time","sap/suite/ui/generic/template/lib/testableHelper","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/modelHelper"],function(q,B,N,D,S,M,a,T,F,b,c,d,t,J,V,A,m){"use strict";function g(p,i){var o;if(i){o=N.getCurrencyInstance({showMeasure:false});}else{o=N.getFloatInstance({precision:p.precision,decimals:p.scale});}return function(P,u){P=o.format(P,u);if(u){P+=" "+u;}return P;};}function e(C,p,s){var o=C.getModel("entitySet").getMetaModel(),h=o.getObject(o.getMetaContext(C.sPath).sPath),P=o.getObject(o.getMetaContext(C.sPath+"/"+p).sPath),i={path:p,data:{type:P.type,displayFormat:" ",label:s,textPath:p,textArrangement:A.getTextArrangement(h,P),unit:null,fnDecimalFormatter:null}},O="Org.OData.Measures.V1.Unit",j="Org.OData.Measures.V1.ISOCurrency",I=false,l,n,r,L;if(P){if(P.extensions){L=P.extensions.length;for(var k=0;k<L;k++){l=P.extensions[k];if(l.namespace==="http://www.sap.com/Protocols/SAPData"){switch(l.name){case"display-format":i.data.displayFormat=l.value;break;case"label":if(!i.data.label){i.data.label=l.value;}break;case"text":n=l.value;r=p.split("/");r[r.length-1]=n;i.data.textPath=r.join("/");break;default:break;}}}}if(i.data.label===""||i.data.label===undefined){i.data.label=p;}if(P.type==="Edm.Decimal"){if(P[j]){i.data.unit=P[j].Path;I=true;}else if(P[O]){i.data.unit=P[O].Path;}i.data.fnDecimalFormatter=g(P,I);}}return i;}function G(p,C){var h={};return function(o){var P=o.getProperty(p),s="",i,u,j,k,l;i=h[p];if(!i){i=e(o,p,C);h[p]=i;}if(i.data.textPath&&i.data.textPath!==""){j=o.getProperty(i.data.textPath);}switch(i.data.type){case"Edm.DateTime":if(i.data.displayFormat==="Date"){if(P&&P!==""&&P.getTime){k=D.getDateInstance({style:"medium"});l=new Date(0).getTimezoneOffset()*60*1000;P=k.format(new Date(P.getTime()+l));}}break;case"Edm.Time":if(P&&P!==""){P=new d().formatValue(P,"string");}break;case"Edm.Boolean":if(P===true){P="{i18n>YES}";}else if(P===false){P="{i18n>NO}";}break;case"Edm.Decimal":u=(i.data.unit)?o.getProperty(i.data.unit):"";P=i.data.fnDecimalFormatter(P,u);break;default:break;}if(!j||i.data.textPath===p){s=P?P:"";}else{switch(i.data.textArrangement){case"idAndDescription":s=P+" ("+j+")";break;case"idOnly":s=P;break;case"descriptionOnly":s=j;break;default:s=j+(P?" ("+P+")":"");break;}}return{key:s?s:p,text:i.data.label?i.data.label+": "+s:s};};}function f(C,o,s,h){function E(i){var j={};for(var k in i){var x=i[k];if(typeof x==="string"){j[k]=x;}else if(typeof x==="object"){if(x.value){j[k]=E(x).value;}else{j[k]=x;}}}return j;}function H(i){if(i instanceof sap.ui.generic.app.navigation.service.NavError){if(i.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){sap.m.MessageBox.show(h.getText("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:h.getText("ST_GENERIC_ERROR_TITLE")});}else{sap.m.MessageBox.show(i.getErrorCode(),{title:h.getText("ST_GENERIC_ERROR_TITLE")});}}}function l(){var i=C.getView().getBindingContext();return s.oApplication.getDraftSiblingPromise(i);}function n(j){var k=j;var x=-1;var B1=h.getOwnerControl(j);if(B1.getTable){B1=B1.getTable();}var C1=h.isAnalyticalTable(B1);var D1=o.getViewLevel();var E1;if(!C1){var F1=h.getTableBindingInfo(B1);var G1=F1&&F1.binding;var H1=null;if(G1){if(h.isTreeTable(B1)){var I1=(G1.getLength()>0)?G1.getLength():0;if(I1>0){H1=[];for(var J1=0;J1<I1;J1++){H1.push(G1.getContextByIndex(J1));}}}else if(h.isUiTable(B1)){H1=G1.getContexts();}else if(B1 instanceof T){H1=G1.getCurrentContexts();}}var K1=null;var L1=h.getSelectedContexts(B1);var M1=null;if(L1&&L1.length>0){M1=L1[0].getPath();}else if(k){M1=k.getBindingContext()?k.getBindingContext().sPath:null;}if(G1&&G1.getContexts&&M1){for(var i=0;i<H1.length;i++){K1=H1[i];if(K1&&K1.getPath()===M1){x=i;break;}}}if(B1&&x!==-1&&H1.length>0){var N1;if(B1 instanceof T){N1=B1.getGrowingThreshold();}else if(h.isUiTable(B1)){N1=B1.getThreshold();}var O1=D1>0?h.getTableBindingInfo(B1).path:null;var P1=function(Q1){return{context:Q1,navigationData:{navigationProperty:O1}};};E1=H1&&{listBinding:G1,growingThreshold:N1,selectedRelativeIndex:x,objectPageNavigationContexts:H1,navigitionInfoProvider:P1};}}o.setPaginatorInfo(E1,true);}function p(j,k){var x=C.getView().getModel().getMetaModel();var B1=k;var C1=x.getODataEntitySet(j,false);var D1=x.getODataEntityType(C1.entityType,false);var E1=D1.key.propertyRef;var i;var F1=s.oDraftController.getDraftContext();if(F1.isDraftEnabled(j)){E1=E1.concat(F1.getSemanticKey(j));E1.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(B1.parameters.select&&B1.parameters.select.length>0){var G1=B1.parameters.select.split(",");for(i=0;i<E1.length;i++){if(q.inArray(E1[i].name,G1)===-1){B1.parameters.select+=","+E1[i].name;G1=B1.parameters.select.split(",");}}}return B1;}function r(i,j){var k=i.getSource().getUrl();i.preventDefault();h.processDataLossConfirmationIfNonDraft(function(){sap.m.URLHelper.redirect(k,false);},q.noop,j);}function u(i,j){i.preventDefault();var k=i.getSource().getHref();h.processDataLossConfirmationIfNonDraft(function(){window.location.hash=k;},q.noop,j);}function v(j){var k=[];return h.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(i){var x=i.getSource().getParent();x.close();},onDelete:function(x){var B1=x.getSource().getParent();var C1=B1.getModel("delete");var D1=C1.getProperty("/items");var E1=[];var F1=[];var G1=[];k=[];for(var i=0;i<D1.length;i++){if(!D1[i].draftStatus.locked&&D1[i].deletable){if(!D1[i].draftStatus.draft){if(D1[i].draftStatus.draftActive){G1.push(D1[i].context.sPath);}else if(D1.length===C1.getProperty("/unsavedChangesItemsCount")||!D1[i].draftStatus.unsavedChanges||C1.getProperty("/checkboxSelected")){E1.push(D1[i].context.sPath);}}else{F1.push(D1[i].context.sPath);k.push(D1[i].context.sPath);}}}F1=F1.concat(E1).concat(G1);s.oCRUDManager.deleteEntities(F1).then(function(H1){var I1=0;var J1=[];for(var i=0;i<H1.length;i++){J1.push("/"+H1[i].split('/')[1]);if(k.indexOf(J1[i])!==-1){I1=I1+1;}}var K1=j.getTable();K1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",false);var L1=F1.length-G1.length-(H1.length-I1);if((H1.length-I1)>0){var M1="";if(L1>0){M1+=(L1>1)?h.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL_WITH_COUNT",[L1]):h.getText("ST_GENERIC_DELETE_SUCCESS_WITH_COUNT",[L1]);M1+="\n";M1+=(H1.length>1)?h.getText("ST_GENERIC_DELETE_ERROR_PLURAL_WITH_COUNT",[H1.length]):h.getText("ST_GENERIC_DELETE_ERROR_WITH_COUNT",[H1.length]);}else{M1=(H1.length>1)?h.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):h.getText("ST_GENERIC_DELETE_ERROR");}M.error(M1);}else{var N1="";N1=(L1>1)?h.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):h.getText("ST_GENERIC_OBJECT_DELETED");s.oApplication.showMessageToast(N1);}h.refreshSmartTable(j);},function(H1){M.error(h.getText("ST_GENERIC_DELETE_ERROR_PLURAL",[F1.length]),{styleClass:h.getContentDensityClass()});});B1.close();}},"delete");}function w(i,j){return new Promise(function(k,x){j.read(i+"/SiblingEntity",{success:function(B1){var C1="/"+j.getKey(B1);k(C1);},error:function(B1){var C1="Error";k(C1);}});});}function y(j){var k=C.getView().getModel();var x=k.getMetaModel();var B1=x.getODataEntitySet(C.getOwnerComponent().getEntitySet());var C1=B1["Org.OData.Capabilities.V1.DeleteRestrictions"];var D1=(C1&&C1.Deletable&&C1.Deletable.Path)?C1.Deletable.Path:"";var E1={items:undefined,itemsCount:j.length,text:{title:undefined,shortText:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,checkboxSelected:true};var F1=[];var G1=[];var H1,I1,J1,K1,L1;var M1=[];for(var i=0;i<j.length;i++){H1=k.getObject(j[i].getPath());if(!H1.IsActiveEntity){if(H1.HasActiveEntity){M1.push(w(j[i].getPath(),k));}}}var N1=0;return new Promise(function(O1,P1){Promise.all(M1).then(function(Q1){for(var i=0;i<j.length;i++){H1=k.getObject(j[i].getPath());I1={};J1={};K1=true;L1={};if(!H1.IsActiveEntity){I1.draft=true;if(H1.HasActiveEntity){J1.draft=false;J1.draftActive=true;if(Q1[N1]!="Error"){L1["oModel"]=j[0].getModel();L1["sPath"]=Q1[N1++];}}}else if(H1.HasDraftEntity){var R1=k.getProperty("DraftAdministrativeData/CreatedByUserDescription",j[i]);if(!R1){R1=k.getProperty("DraftAdministrativeData/InProcessByUser",j[i]);}if(R1){I1.locked=true;I1.user=R1;E1.lockedItemsCount++;}else{I1.unsavedChanges=true;I1.user=k.getProperty("DraftAdministrativeData/LastChangedByUser",j[i]);E1.unsavedChangesItemsCount++;}}if(D1&&D1!==""){if(k.getProperty(D1,j[i])===false){K1=false;E1.undeletableCount++;}}F1.push({context:j[i],draftStatus:I1,deletable:K1});if(!H1.IsActiveEntity&&H1.HasActiveEntity){G1.push({context:L1,draftStatus:J1,deletable:K1});}}if(G1.length>0){F1=F1.concat(G1);}E1.items=F1;if(E1.lockedItemsCount===E1.itemsCount){E1.text.title=h.getText("ST_GENERIC_ERROR_TITLE");}else{E1.text.title=(E1.itemsCount>1)?h.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[E1.itemsCount]):h.getText("ST_GENERIC_DELETE_TITLE");}E1.text.unsavedChanges=h.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(E1.itemsCount>1){if(E1.lockedItemsCount===E1.itemsCount){E1.text.shortText=h.getText("ST_GENERIC_DELETE_LOCKED_PLURAL");}else if(E1.unsavedChangesItemsCount===E1.itemsCount){E1.text.shortText=h.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL");}else if(E1.lockedItemsCount>0){var S1=E1.itemsCount-E1.lockedItemsCount;E1.text.shortText=(E1.lockedItemsCount>1)?h.getText("ST_GENERIC_CURRENTLY_LOCKED_PLURAL",[E1.lockedItemsCount,E1.itemsCount]):h.getText("ST_GENERIC_CURRENTLY_LOCKED",[E1.itemsCount]);E1.text.shortText+="\n";if(S1===E1.unsavedChangesItemsCount){E1.text.shortText+=(S1>1)?h.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL"):h.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");}else{E1.text.shortText+=(S1>1)?h.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[S1]):h.getText("ST_GENERIC_DELETE_REMAINING");}}else{E1.text.shortText=h.getText("ST_GENERIC_DELETE_SELECTED_PLURAL");}if(E1.undeletableCount>0){E1.text.undeletableText=h.getText("ST_GENERIC_DELETE_UNDELETABLE",[E1.undeletableCount,E1.itemsCount]);}}else{if(E1.lockedItemsCount>0){E1.text.shortText=h.getText("ST_GENERIC_DELETE_LOCKED",[" ",E1.items[0].draftStatus.user]);}else if(E1.unsavedChangesItemsCount>0){E1.text.shortText=h.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",E1.items[0].draftStatus.user]);}else{E1.text.shortText=h.getText("ST_GENERIC_DELETE_SELECTED");}}O1({"mJSONData":E1});});});}function z(i,j,k,x){var B1=h.getNavigationHandler();var C1={};var D1={};for(var E1 in i.parameters){if(q.isEmptyObject(i.parameters[E1])){C1[E1]=i.parameters[E1];}else{D1[E1]=i.parameters[E1];}}D1=E(D1);B1.mixAttributesAndSelectionVariant({},x).getParameterNames().forEach(function(E1){delete C1[E1];});var F1=k&&k.getObject();var G1=j&&j.getObject?j.getObject():j&&j[0];var H1=q.extend({},C1,F1,G1,D1);return B1.mixAttributesAndSelectionVariant(H1,x);}function I(i,j,k,x){var B1=h.getNavigationHandler();var C1;if(k){C1=k.getUiState().getSelectionVariant();if(typeof C1!=="string"){C1=JSON.stringify(C1);}}var D1=z(i,j,C.getView().getBindingContext(),C1);var E1={semanticObject:i.semanticObject,action:i.action};C.adaptNavigationParameterExtension(D1,E1);B1.navigate(i.semanticObject,i.action,D1.toJSONString(),null,H);}function K(i){var j=h.getNavigationHandler();var k={semanticObject:i.semanticObject,action:i.action};var x=j.mixAttributesAndSelectionVariant(i.semanticAttributes);C.adaptNavigationParameterExtension(x,k);j.navigate(i.semanticObject,i.action,x.toJSONString(),null,H);}function L(i,k){var x=i.byId("icon");var B1=x&&x.getSrc();if(B1===""){B1=undefined;}var C1=i.byId("title");var D1=C1&&C1.getText();if(D1===""){D1=undefined;}var E1=i.byId("description");var F1=E1&&E1.getText();if(F1===""){F1=undefined;}for(var j=0;j<k.length;j++){var G1=k[j];var H1=A.getStableIdPartFromFacet(G1)+"::contactTitleAreaIcon";var I1=i.byId(H1);var J1=A.getStableIdPartFromFacet(G1)+"::contactTitleAreaTitle";var K1=i.byId(J1);var L1=A.getStableIdPartFromFacet(G1)+"::contactTitleAreaDescription";var M1=i.byId(L1);var N1=I1&&I1.getSrc();if(N1===""){N1=undefined;}var O1=K1&&K1.getText();if(O1===""){O1=undefined;}var P1=M1&&M1.getText();if(P1===""){P1=undefined;}if(B1&&N1&&D1&&O1&&F1&&P1){if((B1===N1||!N1)&&(D1===O1||!O1)&&(F1===P1||!P1)){var Q1=A.getStableIdPartFromFacet(G1)+"::contactTitleArea";var R1=i.byId(Q1);if(R1&&R1.setVisible){R1.setVisible(false);}}}}}function O(i,j,k,x){var B1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var C1=B1.crossNavigation.outbounds[i.data("CrossNavigation")];var D1;if(k){if(h.isSmartChart(i)){D1=h.getOwnerControl(x)||h.getOwnerControl(i);}else{D1=h.getOwnerControl(i).getParent();}}I(C1,j,k,D1);}function P(j,k){for(var i=0;i<j.length;i++){if(j[i].indexOf("/")!==-1){var x=j[i].split("/");x.pop();var B1=x.join("/");if(k.indexOf(B1)===-1){k.push(B1);}}}}function Q(i,j){}function R(i,j){h.processDataLossConfirmationIfNonDraft(function(){var k=i.data('SemanticObject');var x=i.data('Action');var B1=i.data('SemanticAttributes');if(k&&x){var C1={semanticObject:k,action:x};if(B1){B1="{"+B1+"}";C1.semanticAttributes=JSON.parse(B1);}K(C1);}},q.noop);}function U(k,x,B1,C1,D1){var E1="";var F1=function(i2){var j2=i2.dependent.propertyRef;var k2=x.originalId;var l2=C.getView().byId(k2);if(l2&&l2.mProperties.fieldName){for(var m2 in j2){if(j2[m2].name===l2.mProperties.fieldName){E1=l2.mProperties.fieldName;return true;}}}if(!l2){var n2=q("#"+k2.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(n2){l2=n2.control(0);if(l2&&l2.mProperties.fieldName){for(var m2 in j2){if(j2[m2].name===l2.mProperties.fieldName){E1=l2.mProperties.fieldName;return true;}}}}}return false;};var G1=function(){var H1,O1,i2,j2,k2,l2,m2;O1=k.getModel().getMetaModel();i2=O1.getODataEntitySet(k.getEntitySet());j2=O1.getODataEntityType(i2.entityType);if(!j2||!j2.navigationProperty){return;}for(var i=0;i<j2.navigationProperty.length;i++){k2=j2.navigationProperty[i];if(k2.name==="SiblingEntity"||k2.name==="DraftAdministrativeData"){continue;}var n2=k2.relationship;var o2=n2.lastIndexOf(".");var p2=n2.slice(0,o2);var q2=n2.slice(o2+1);var r2=O1.getObject("/dataServices/schema");var s2;for(var j in r2){if(r2[j].namespace===p2){s2=r2[j];break;}}var t2=s2.association;var u2;for(var j in t2){if(t2[j].name===q2){u2=t2[j];break;}}var v2=u2.referentialConstraint;if(v2&&v2.dependent&&v2.dependent.propertyRef){var w2=F1(v2);if(w2){l2=O1.getODataAssociationEnd(j2,k2.name);m2=O1.getODataEntityType(l2.type);var x2=O1.getODataEntityContainer();var y2="";var z2="";var A2="";for(var j=0;j<x2.entitySet.length;j++){var B2=m2.entityType;if(!B2){B2=m2.namespace+"."+m2.name;}if(x2.entitySet[j].entityType===B2){y2=x2.entitySet[j].name;z2=x2.entitySet[j].entityType;break;}}H1={navigation:k2.name,entitySet:y2,entityType:z2};if(m2["com.sap.vocabularies.UI.v1.HeaderInfo"]&&z2){var A2=O1.getODataEntityType(z2,true)+"/com.sap.vocabularies.UI.v1.HeaderInfo";H1.headerInfoPath=A2;}if(m2["com.sap.vocabularies.UI.v1.QuickViewFacets"]&&z2){var C2=O1.getODataEntityType(z2,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";H1.quickViewFacetODataPath=C2;}return H1;}}}return H1;};var H1=G1();var I1=false;var J1=false;var K1=false;var L1=[];var M1=C.getOwnerComponent();var N1=M1.getModel();var O1=N1.getMetaModel();if(H1){if(H1.quickViewFacetODataPath){var P1=O1.createBindingContext(H1.quickViewFacetODataPath,true);var Q1=P1&&P1.getModel().getObject(P1.getPath());if(Q1){I1=true;for(var j=0;j<Q1.length;j++){var R1=Q1[j];if(R1&&R1.Target&&R1.Target.AnnotationPath){if(R1.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){J1=true;}else if(R1.Target.AnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){K1=true;L1.push(R1);}}}}}}if(I1){var S1,T1;S1=O1.getODataEntitySet(k.getEntitySet());T1=O1.getODataEntityType(S1.entityType);var U1=H1.headerInfoPath&&O1.createBindingContext(H1.headerInfoPath,true);var D1=x.mainNavigation;var V1=x.semanticObject;var W1,X1;if(V1&&D1){var Y1=D1.getTarget&&D1.getTarget()||"";var Z1=D1.getKey&&D1.getKey();if(Z1){var $1=Z1.split(V1+"-");W1=$1&&$1[1];if(V1&&W1){X1={"Target":Y1,"SemanticObject":V1,"Action":W1};}if(x.semanticAttributes){X1.SemanticAttributes=x.semanticAttributes;for(var i in x.semanticAttributes){var _1=x.semanticAttributes[i];if(_1.indexOf("{\"__deferred\":")>-1){delete X1.SemanticAttributes[i];}if(_1.indexOf("{\"__ref\":")>-1){delete X1.SemanticAttributes[i];}}if(X1.SemanticAttributes){var a2=JSON.stringify(X1.SemanticAttributes);if(a2&&a2.length>1){X1.SemanticAttributes=a2.substring(1,a2.length-1);}}}}}var b2=O1.getODataProperty(T1,E1);var c2=k&&k.mProperties&&k.mProperties.fieldSemanticObjectMap;var d2=new J({sourceClickedField:b2,sourceEntityType:T1,showFieldGroup:J1,showContact:K1,ignoredFields:c2,navigationPath:H1.navigation,mainNavigation:X1});d2.setDefaultBindingMode("OneWay");var e2={};e2.oState=B1;e2._templateEventHandlers={};e2._templateEventHandlers.onSemanticObjectLinkNavigationPressed=C._templateEventHandlers.onSemanticObjectLinkNavigationPressed.bind(C._templateEventHandlers);e2._templateEventHandlers.onDataFieldWithIntentBasedNavigation=C._templateEventHandlers.onDataFieldWithIntentBasedNavigation.bind(C._templateEventHandlers);e2.onInit=function(){};e2.onExit=function(){};e2.onAfterRendering=function(){var C=this;var f2=C.oView;var i2=f2.getParent().getParent().getParent();i2.setBusy(false);};e2.connectToView=C.connectToView.bind(e2);var f2=sap.ui.view({async:true,preprocessors:{xml:{bindingContexts:{sourceEntitySet:O1.createBindingContext(O1.getODataEntitySet(k.getEntitySet(),true)),entitySet:O1.createBindingContext(O1.getODataEntitySet(H1.entitySet,true)),header:U1,facetCollection:P1},models:{sourceEntitySet:O1,entitySet:O1,header:O1,facetCollection:O1,quickView:d2,parameter:o.getParameterModelForTemplating()}}},controller:e2,type:V.XML,viewName:"sap.suite.ui.generic.template.fragments.QuickViewSmartForm",height:"100%"});x.show(undefined,undefined,undefined,f2);var g2=function(i2){var j2=i2.getSource();if(j2){var k2=j2.getParent().getParent().getParent();k2.setBusy(true);k2.setBusyIndicatorDelay(10);}};f2.attachBeforeRendering(g2.bind(this));var h2=function(i2){var j2=i2.getSource();if(j2){var k2=j2.byId("ownTitleArea");if(k2){var l2=j2.getParent();if(l2&&l2.getItems){var m2=l2.getItems()&&l2.getItems()[0];if(m2&&m2!=j2){m2.setVisible(false);}}}if(K1&&L1&&k2){L(j2,L1);}}};f2.attachAfterRendering(h2.bind(this));}else{x.show(C1,D1,undefined,undefined);}}function W(C,i){var x=C.getView&&C.getView().getBindingContext();var B1=x.getObject();var C1=C.getOwnerComponent().getModel().getMetaModel();var D1=C1.getODataEntitySet(C.getOwnerComponent().getEntitySet());var E1=C1.getODataEntityType(D1.entityType);var F1=E1["com.sap.vocabularies.Common.v1.SemanticKey"];var G1={};if(F1&&F1.length>0){for(var j=0;j<F1.length;j++){var H1=F1[j].PropertyPath;if(!G1[H1]){G1[H1]=[];G1[H1].push(B1[H1]);}}}else{for(var k in E1.key.propertyRef){var I1=E1.key.propertyRef[k].name;if(!G1[I1]){G1[I1]=[];G1[I1].push(B1[I1]);}}}return G1;}function X(k,i,x,B1){if(k[i].entitySet==x&&B1===k[i].navigationProperty&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].entitySet==x&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].pages){for(var j=0;j<(k[i].pages.length);j++){var C1=X(k[i].pages,j,x,B1);if(C1!==undefined&&C1!==null){return C1;}}}}function Y(i){var j=i.getSource().getTable();var k=i.getSource().getEntitySet();var x=i.getSource().getTableBindingPath();var B1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");var C1=C.getOwnerComponent().getAppComponent().getConfig().pages;var D1=X(C1,0,k,x);if(D1!==undefined&&D1!==null&&B1){var E1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app").crossNavigation.outbounds[D1];if(E1){var F1=E1.semanticObject;var G1=E1.action;var H1=C.getView().getModel("_templPriv");var I1=H1.getProperty("/generic/supportedIntents/");var J1=(x==="")?k:k+"::"+x;var K1=H1.getProperty("/generic/supportedIntents/"+F1+"/"+G1+"/"+J1);if(!K1){var L1={},M1;var N1=C.getOwnerComponent().getAppComponent();for(var O1 in E1.parameters){if(!q.isEmptyObject(E1.parameters[O1])){L1[O1]=E1.parameters[O1];}}if(C.getMetadata().getName()==='sap.suite.ui.generic.template.ObjectPage.view.Details'){M1=W(C,N1);}var P1={semanticObject:F1,action:G1};var Q1=q.extend({},M1,L1);var R1={target:P1,params:Q1};var S1=B1.isNavigationSupported([R1],N1);S1.done(function(T1){var U1=H1.getProperty("/generic/supportedIntents/"+F1);if(!U1){I1[F1]={};I1[F1][G1]={};I1[F1][G1][J1]={"supported":T1[0].supported};}else if(!U1[G1]){U1[G1]={};U1[G1][J1]={"supported":T1[0].supported};}else{U1[G1][J1]={"supported":T1[0].supported};}H1.updateBindings();if(T1[0].supported&&h.isUiTable(j)){var V1=j.getRowActionTemplate();V1.getItems()[0].setVisible(true);j.setRowActionTemplate(V1);}});}}}}function Z(i){h.setEnabledToolbarButtons(i.getSource());Y(i);}function $(i,j){if(!o.isDraftEnabled()||!i){return;}var k=i.getControlByKey("EditState");var x=k&&k.getSelectedKey()||"";switch(x){case"1":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":j.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var B1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(j.filters[0]&&j.filters[0].aFilters){var C1=j.filters[0];j.filters[0]=new F([C1,B1],true);}else{j.filters.push(B1);}break;}}function _(i,j,k){var x,B1;if(i){B1=i.split(",");x=B1.length;while(x--){i=B1[x];if(i&&j.indexOf(i)<0){j.push(i);k.parameters.select+=","+i;}}}}function a1(B1,C1){var D1=B1.getSource();var E1=D1.getTable(),F1=function(z2){return z2.getMetadata().getName();};if(F1(E1)==="sap.m.Table"){var G1=E1.getColumns();for(var H1=0;H1<G1.length;H1++){if(G1[H1].getCustomData()[0].getValue()&&G1[H1].getCustomData()[0].getValue()["actionButton"]==="true"){G1[H1].setPopinDisplay("WithoutHeader");}}}var I1=B1.getParameter("bindingParams");I1.parameters=I1.parameters||{};if(D1.data().allowSearch){I1.parameters["custom"]={"search":B1.getSource().data().searchString};D1.data("allowSearch",false);}else if(D1.getBindingContext()&&D1.getBindingContext().getPath()===D1.data().objectPath){if(D1.getId()===D1.data().tableId){if(!!B1.getSource().data().searchString){I1.parameters["custom"]={"search":B1.getSource().data().searchString};}}}if(D1.data().allowSearchWorkListLight){I1.parameters["custom"]={"search":B1.getSource().data().searchString};D1.data("allowSearchWorkListLight",false);if(!!B1.getSource().data().searchString){I1.parameters["custom"]={"search":B1.getSource().data().searchString};}}var J1=C.byId(D1.getSmartFilterId());if(!J1&&C.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'){J1=C.byId("listReportFilter");var K1=J1.getBasicSearchValue();if(!!K1){I1.parameters["custom"]={"search":K1};}}$(J1,I1);p(D1.getEntitySet(),I1);var L1=I1.parameters.select&&I1.parameters.select.split(",")||[];var M1=I1.parameters&&I1.parameters.expand&&I1.parameters.expand.split(",")||[];var N1=D1.getEntitySet();if(L1&&L1.length>0){var O1=D1.getModel().getMetaModel();var P1=O1.getODataEntitySet(N1);var Q1={};var R1=O1.getODataEntityType(P1.entityType);for(var S1=0;S1<L1.length;S1++){var T1=L1[S1];if(T1){var Q1=O1.getODataProperty(R1,T1);if(Q1&&Q1["com.sap.vocabularies.Common.v1.FieldControl"]&&Q1["com.sap.vocabularies.Common.v1.FieldControl"].Path){var U1=Q1["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(U1!==" "&&I1.parameters.select.search(U1)===-1){I1.parameters.select+=","+U1;L1.push(U1);}}}}if(F1(E1)==="sap.m.Table"){var V1=I1.sorter[0];if(V1&&V1.vGroup){var W1=m.getODataProperty(O1,R1,V1.sPath);var X1=W1["com.sap.vocabularies.Common.v1.Text"]&&W1["com.sap.vocabularies.Common.v1.Text"].Path;if(X1){if(q.inArray(X1,L1)===-1){I1.parameters.select+=","+X1;L1.push(X1);}}}}var Y1=P1["Org.OData.Capabilities.V1.DeleteRestrictions"];if(Y1&&Y1.Deletable&&Y1.Deletable.Path&&I1.parameters.select.search(Y1.Deletable.Path)===-1){I1.parameters.select+=","+Y1.Deletable.Path;L1.push(Y1.Deletable.Path);}var Z1=P1["Org.OData.Capabilities.V1.UpdateRestrictions"];if(Z1&&Z1.Updatable&&Z1.Updatable.Path&&I1.parameters.select.search(Z1.Updatable.Path)===-1){I1.parameters.select+=","+Z1.Updatable.Path;L1.push(Z1.Updatable.Path);}var $1,_1;var R1=O1.getODataEntityType(P1.entityType);var a2=R1["com.sap.vocabularies.UI.v1.LineItem"]||[];var b2=R1["com.sap.vocabularies.UI.v1.LineItem"];var c2="com.sap.vocabularies.UI.v1.Criticality";var d2=D1.getCustomData();for(var x=0;x<d2.length;x++){if(d2[x].getKey()&&d2[x].getKey()==="lineItemQualifier"){var e2=d2[x].getValue();if(e2){b2=R1["com.sap.vocabularies.UI.v1.LineItem#"+e2];c2="com.sap.vocabularies.UI.v1.Criticality#"+e2;break;}}}if(b2&&c2&&b2[c2]&&b2[c2].Path){L1.push(b2[c2].Path);I1.parameters.select+=","+b2[c2].Path;}for(var S1=0;S1<a2.length;S1++){if(a2[S1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){$1=O1.getODataFunctionImport(a2[S1].Action.String,true);if($1){_1=O1.getObject($1);if(_1["sap:action-for"]!==" "&&_1["sap:applicable-path"]!==" "&&I1.parameters.select.search(_1["sap:applicable-path"])===-1){I1.parameters.select+=","+_1["sap:applicable-path"];L1.push(_1["sap:applicable-path"]);}}}if(a2[S1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||a2[S1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){var f2,g2;if(a2[S1].Value&&a2[S1].Value.Path){f2=O1.getODataProperty(R1,a2[S1].Value.Path);if(f2){g2=f2["sap:text"]||(f2["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";}if(!g2){g2=a2[S1].Value.Path;}if(L1.indexOf(g2)===-1){L1.push(g2);I1.parameters.select=I1.parameters.select+","+g2;}}}if(a2[S1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(a2[S1].Target&&a2[S1].Target.AnnotationPath){var h2=a2[S1].Target.AnnotationPath;var i2=h2.split("@")[1];var j2=R1[i2];if(j2&&j2.MeasureAttributes){if(j2.MeasureAttributes[0]&&j2.MeasureAttributes[0].DataPoint&&j2.MeasureAttributes[0].DataPoint.AnnotationPath){var k2=j2.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var l2=R1[k2];if(l2){for(var m2 in l2){if(l2[m2]&&l2[m2].Path&&L1.indexOf(l2[m2].Path)===-1){I1.parameters.select=I1.parameters.select+","+l2[m2].Path;L1.push(l2[m2].Path);}if(m2==="CriticalityCalculation"&&l2.CriticalityCalculation){for(var n2 in l2.CriticalityCalculation){if(l2.CriticalityCalculation[n2].Path&&L1.indexOf(l2.CriticalityCalculation[n2].Path)===-1){I1.parameters.select=I1.parameters.select+","+l2.CriticalityCalculation[n2].Path;L1.push(l2.CriticalityCalculation[n2].Path);}}}}}}}if(j2&&j2.Measures){if(j2.Measures[0]&&j2.Measures[0].PropertyPath&&L1.indexOf(j2.Measures[0].PropertyPath)===-1){I1.parameters.select=I1.parameters.select+","+j2.Measures[0].PropertyPath;L1.push(j2.Measures[0].PropertyPath);}}}}}var o2=h.getBreakoutActions(D1);for(var p2 in o2){if(o2[p2].requiresSelection&&o2[p2].applicablePath){if(I1.parameters.select.search(o2[p2].applicablePath)===-1){I1.parameters.select+=","+o2[p2].applicablePath;L1.push(o2[p2].applicablePath);}}}}P(L1,M1);var q2=s.oDraftController.getDraftContext();if(q2.isDraftEnabled(N1)&&q2.isDraftRoot(N1)){if(q2.hasDraftAdministrativeData(N1)){if(L1&&L1.length>0){if(L1.indexOf("DraftAdministrativeData")===-1){L1.push("DraftAdministrativeData");I1.parameters.select=I1.parameters.select+",DraftAdministrativeData";}}if(M1.indexOf("DraftAdministrativeData")===-1){M1.push("DraftAdministrativeData");}}}if(M1.length>0){I1.parameters.expand=M1.join(",");}var r2=D1.getCustomData();var s2={};for(var k=0;k<r2.length;k++){s2[r2[k].getKey()]=r2[k].getValue();}var t2=D1.fetchVariant();if(!s2.TemplateSortOrder&&C1&&C1.determineSortOrder){s2.TemplateSortOrder=C1.determineSortOrder();}if((!t2||!t2.sort)&&(F1(E1)==="sap.m.Table")&&s2.TemplateSortOrder){var u2=s2.TemplateSortOrder.split(", ");for(var j=0;j<u2.length;j++){var v2=u2[j].split(" ");if(v2.length>1){I1.sorter.push(new b(v2[0],v2[1]==="true"));}else{I1.sorter.push(new b(v2[0]));}}}if(F1(E1)==="sap.m.Table"){var V1=I1.sorter[0];if(V1&&V1.vGroup){var w2;var x2=null;for(var i=0;i<G1.length;i++){if(G1[i].data("p13nData").leadingProperty===V1.sPath){x2=G1[i];break;}}if(x2){var w2=x2.getHeader().getProperty("text");V1.fnGroup=G(V1.sPath,w2);var y2=x2.data("p13nData").additionalProperty;_(y2,L1,I1);}}}}function b1(i,j,k){k=k||i.getBindingContext();h.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){O(i,k,j.oSmartFilterbar);return;}var x=h.getOwnerControl(i);n(i);h.navigateFromListItem(k,x);},q.noop,j);}function c1(i){s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore incorrect selection, since app is busy anyway");return;}var j=i?"ST_GENERIC_MULTIPLE_ITEMS_SELECTED":"ST_GENERIC_NO_ITEM_SELECTED";M.error(h.getText(j),{styleClass:h.getContentDensityClass()});});}function d1(i,j){var k=i.getParent().getParent().getTable();var x=h.getSelectedContexts(k);if(x.length===1){h.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){O(i,x[0],j.oSmartFilterbar);return;}n(i);h.navigateFromListItem(x[0],k);},q.noop,j);}else{c1(x.length);}}function e1(k){var x,i,B1;var C1=C.getOwnerComponent(),D1=k.getSource().getCustomData(),E1="10rem";if(D1.length===0){return;}for(i=0,B1=D1.length;i<B1;i++){if(D1[i].getProperty("key")==="Target"){x=D1[i].getProperty("value");break;}}if(!x){M.show(h.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:h.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:E1,details:h.getText("ST_GENERIC_ERROR_IN_NAVIGATION_PROPERTY_MISSING",["DataFieldWithNavigationPath"])});return;}var F1=C1.getModel(),G1=F1.getMetaModel();var H1=k.getSource().getBindingContext().getPath(),I1=H1.slice(1,H1.indexOf("(")),J1=G1.getODataEntityType(G1.getODataEntitySet(I1).entityType),j,K1=false,L1=J1.navigationProperty.length;for(j=0;j<L1;j++){if(J1.navigationProperty[j].name===x){K1=true;break;}}if(!K1){M.show(h.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:h.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:E1,details:h.getText("ST_GENERIC_ERROR_NAVIGATION_PROPERTY_NOT_CORRECT",[x,"DataFieldWithNavigationPath"])});return;}var M1=G1.getODataAssociationEnd(J1,x),N1=G1.getODataEntityType(M1.type),O1,P1;if(N1){O1=N1.namespace+"."+N1.name;}var Q1=G1.getODataEntityContainer().entitySet;for(i=0,B1=Q1.length;i<B1;i++){if(Q1[i].entityType===O1){P1=Q1[i].name;break;}}if(!P1){var R1=O1.split(".")[1];R1=R1.slice(0,R1.length-4);M.show(h.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:M.Icon.ERROR,title:h.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:E1,details:h.getText("ST_NAV_ERROR_TARGET_ENTITYSET_IS_MISSING",[R1])});return;}var S1=h.getNavigationKeyProperties(P1),T1=s.oNavigationController,U1={"$expand":""};if(o.isDraftEnabled()){U1={"$expand":"DraftAdministrativeData"};}var V1=new Promise(function(W1,X1){F1.read(H1+"/"+x,{urlParameters:U1,success:function(Y1){W1(Y1);s.oApplication.invalidatePaginatorInfo();var Z1=h.mergeNavigationKeyPropertiesWithValues(S1,Y1);s.oApplication.setStoredTargetLayoutToFullscreen(1);T1.navigateToContext(Z1,null,false);},error:function(Y1){X1(Y1);}});});o.getBusyHelper().setBusy(V1);}function f1(i,j){var k=i.getSource();var x=h.getOwnerControl(k);var B1=h.getSelectedContexts(x);if(B1.length>1){c1(B1.length);}else{h.processDataLossConfirmationIfNonDraft(function(){var C1={action:k.data("Action"),semanticObject:k.data("SemanticObject")};I(C1,B1[0],j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}}function g1(i,j){var k=i.getSource();var x=k.getParent().getBindingContext();var B1=k.data("SemanticObject");var C1=k.data("Action");h.processDataLossConfirmationIfNonDraft(function(){var D1={action:C1,semanticObject:B1};I(D1,x,j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}function h1(i,j,k){h.processDataLossConfirmationIfNonDraft(function(){var x={action:j.Action,semanticObject:j.SemanticObject};I(x,i,k.oSmartFilterbar,k.oSmartTable);},q.noop,k);}function i1(i,j,k){var x=h.getElementCustomData(i);var B1=h.getSelectedContexts(j);var C1=!(x.RequiresContext&&x.RequiresContext==="false");if(C1&&B1.length!==1){c1(B1.length);}else{var D1=C1?B1[0]:null;h1(D1,x,k);}}function j1(i,j){h.processDataLossConfirmationIfNonDraft(function(){var k={semanticObject:i.data("SemanticObject"),action:i.data("Action")};var x=i.getParent().getBindingContext();I(k,x,j.oSmartFilterbar,j.oSmartTable);},q.noop,j);}function k1(i,j){var k=i.getSource();var x=h.getOwnerControl(k).getParent();var B1=[k.getBindingContext()];var C1=h.getElementCustomData(k);var D1=x.getTableBindingPath();h.triggerAction(B1,D1,C1,x,j);}function l1(i,j){var k=C.getView();var x=j?h.getSelectedContexts(j):[k.getBindingContext()];if(x.length===0){c1(x.length);}else{var B1=i.getSource();var C1=h.getElementCustomData(B1);var D1=j?j.getTableBindingPath():k.getBindingPath();h.triggerAction(x,D1,C1,j);}}function m1(i,j){var k,x="";var B1=h.getOwnerControl(i.getSource());var C1=i.getSource().data();var D1=h.getSelectedContexts(B1);if(h.isSmartTable(B1)){k=B1.getTable();x=B1.getTableBindingPath();}else if(h.isSmartChart(B1)){k=B1.getChart();x=B1.getChartBindingPath();}var E1=o1(D1,C1);if(E1.inApplicableCount>0&&(h.isSmartTable(B1)&&((k.getMode&&k.getMode()==="MultiSelect")||(k.getSelectionMode&&k.getSelectionMode()==="MultiToggle")))){var F1=h.getText("ST_GENERIC_WARNING_TEXT",[E1.inApplicableCount]);E1.warningText=F1;var G1={functionImportPath:C1.Action,contexts:E1.aApplicableContexts,sourceControl:k,label:C1.Label,operationGrouping:C1.InvocationGrouping,navigationProperty:"",sBindingPath:x,oState:j};var H1=n1(B1);var I1=H1.getModel("Action");I1.setData(G1);var J1=new sap.ui.model.json.JSONModel(E1);H1.setModel(J1,"list");var K1=H1.getModel("list");K1.setData(E1);H1.open();}else{p1({functionImportPath:C1.Action,contexts:D1,sourceControl:k,label:C1.Label,operationGrouping:C1.InvocationGrouping,navigationProperty:""},j,x);}}function n1(i){return h.getDialogFragment("sap.suite.ui.generic.template.fragments.ActionConfirmation",{onCancel:function(j){var k=j.getSource().getParent();k.close();},onContinue:function(j){var k=j.getSource().getParent();var x=j.getSource().getParent().getModel("Action").getData();p1({functionImportPath:x.functionImportPath,contexts:x.contexts,sourceControl:x.sourceControl,label:x.label,operationGrouping:x.operationGrouping,navigationProperty:x.navigationProperty},x.oState,x.sBindingPath);k.close();}},"Action");}function o1(j,k){var x,B1,C1,D1;var E1=C.getView().getModel();var F1=E1.getMetaModel();if(j&&j.length>0){C1=j[0].sPath.substring(1,j[0].sPath.indexOf('('));D1=F1.getODataEntitySet(C1);}if(D1){var G1=k.Action.split("/")[1];var H1=[],I1=[];var J1={aInApplicableItems:undefined,inApplicableCount:0,dialogTitle:k.Label,warningText:undefined,aApplicableContexts:undefined};if(G1){B1=F1.getODataFunctionImport(G1)["sap:applicable-path"];}for(var i=0;i<j.length;i++){x=E1.getObject(j[i].getPath());if(!x[B1]){J1.inApplicableCount++;var K1=F1.getODataEntityType(F1.getODataEntitySet(C1).entityType);var L1=K1["com.sap.vocabularies.UI.v1.HeaderInfo"].Title.Value.Path;H1.push({sKey:x[L1]});}else{I1.push(j[i]);}}J1.aInApplicableItems=H1;J1.aApplicableContexts=I1;}return J1;}function p1(i,j,k){var x;h.processDataLossConfirmationIfNonDraft(function(){s.oCRUDManager.callAction({functionImportPath:i.functionImportPath,contexts:i.contexts,sourceControl:i.sourceControl,label:i.label,operationGrouping:i.operationGrouping,navigationProperty:i.navigationProperty},j).then(function(B1){if(B1&&B1.length&&B1.length===1){x=B1[0];if(x.response&&x.response.context&&(!x.actionContext||x.actionContext&&x.response.context.getPath()!==x.actionContext.getPath())){s.oApplication.getBusyHelper().getUnbusy().then(s.oViewDependencyHelper.setMeToDirty.bind(null,C.getOwnerComponent(),k));}}});},q.noop,j,"Proceed");}var q1;var r1;function s1(i){q1=true;r1=i;var j=h.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){q.sap.log.info("Draft cancellation confirmed");if(!q1){q.sap.log.info("Draft popover no longer active -> Ignore.");return;}r1();}},"discard");return j;}function t1(i,j){var k=new Promise(function(B1,C1){i.then(function(D1){q.sap.log.info("Active information for current draft has been read. Start discarding the draft");var E1=D1&&D1.getObject();var F1=E1&&E1.IsActiveEntity;var G1=F1?s.oApplication.getTargetAfterCancelPromise(D1):Promise.resolve();G1.then(function(H1){var I1=s.oCRUDManager.deleteEntity(false,true);if(!H1){s.oApplication.prepareDeletionOfCreateDraft(I1);}I1.then(function(){q.sap.log.info("Draft was discarded successfully");j();s.oViewDependencyHelper.setRootPageToDirty();s.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());s.oApplication.invalidatePaginatorInfo();if(H1){q.sap.log.info("Navigate to active entityy");s.oNavigationController.navigateToContext(H1,null,true,1);}B1();},C1);},C1);},C1);});var x={discardPromise:k};o.fire(C,"AfterCancel",x);s.oApplication.getBusyHelper().setBusy(k);k.catch(j);return k;}function u1(i){var j=l();s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore discarding confirmation as app is already busy");return;}var k=C.getView().getBindingContext();var x=k.getObject();var B1=x.hasOwnProperty("HasActiveEntity")&&!k.getProperty("IsActiveEntity")&&!k.getProperty("HasActiveEntity");var C1=k&&k.getPath();var D1=s.oApplication.getIsDraftModified(C1);if(D1){var E1=i.getSource();var F1;var G1=function(){q1=false;F1.close();q.sap.log.info("Draft popover closed");};F1=s1(t1.bind(null,j,G1));var H1=F1.getModel("discard");H1.setProperty("/placement",sap.m.PlacementType.Top);H1.setProperty("/isCreateDraft",B1);F1.openBy(E1);}else{t1(j,q.noop);}});}function v1(){if(o.getViewLevel()!==1||!o.isDraftEnabled()){q.sap.log.warning("Discard draft only possible on root level of draft enabled entities");return Promise.reject();}var i=C.getOwnerComponent();if(!(o.isComponentActive()&&i.getModel("ui").getProperty("/editable"))){q.sap.log.warning("Discard draft only possible in edit mode");return Promise.reject();}var j=l();return t1(j,q.noop);}function w1(i,j,k,x){if(i.data("CrossNavigation")){O(i,i.getBindingContext(),k);return new Promise(function(F1){F1();});}var B1=h.getOwnerControl(i);var C1=B1.getTableBindingPath();var D1=C.getOwnerComponent();var E1=function(F1){var G1=s.oCRUDManager.addEntry(B1,F1).then(function(H1){if(!j){s.oNavigationController.navigateToContext(H1.newContext,H1.tableBindingPath,false,4);s.oApplication.getBusyHelper().getUnbusy().then(s.oViewDependencyHelper.setMeToDirty.bind(null,D1,C1));}else{h.refreshSmartTable(B1);s.oApplicationController.executeSideEffects(D1.getBindingContext(),[],[C1]);}});G1.catch(q.noop);return G1;};if(x instanceof Promise){return x.then(E1);}else{return E1(x);}}function x1(i){var j=h.getOwnerControl(i.getSource());var k=h.getSelectedContexts(j);if(k&&k.length>0){var x=y(k);var B1=v(j);var C1=B1.getModel("delete");x.then(function(x){C1.setData(x.mJSONData);B1.open();});}else{M.error(h.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:h.getContentDensityClass()});}}function y1(i){var j;if(i.getSource().data("Location")==="Header"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="Section"){j=i.getSource().getParent().getElements()[1];}else if(i.getSource().data("Location")==="SmartTable"){j=i.getSource().getParent().getAggregation("items")[0];}else{j=i.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}j.bindElement(i.getSource().getBindingContext().getPath());j.openBy(i.getSource());}function z1(i,j){var k=i.getSource();var x=i.getParameter("bindingParams");x.parameters=x.parameters||{};A1(i,k,x);}function A1(i,j,k){var x=C.byId("listReportFilter");$(x,k);var B1=j.getEntitySet();p(B1,k);}var z=t.testable(z,"fnBuildSelectionVariantForNavigation");var E=t.testable(E,"fnEvaluateParameters");var I=t.testable(I,"fnNavigateIntent");var L=t.testable(L,"fnHideTitleArea");return{onDataReceived:Z,onBeforeRebindTable:a1,onListNavigate:b1,onShowDetails:d1,onEditNavigateIntent:O,onSemanticObjectLinkPopoverLinkPressed:Q,onDataFieldWithNavigationPath:e1,onDataFieldForIntentBasedNavigation:f1,onDeterminingDataFieldForIntentBasedNavigation:i1,onDeterminingDataFieldForAction:l1,onInlineDataFieldForIntentBasedNavigation:j1,onDataFieldWithIntentBasedNavigation:g1,onInlineDataFieldForAction:k1,onSmartFieldUrlPressed:r,onBreadCrumbUrlPressed:u,onCallActionFromToolBar:m1,onDiscardDraft:u1,discardDraftWithoutDialog:v1,addEntry:w1,deleteEntries:x1,onContactDetails:y1,onSemanticObjectLinkNavigationTargetObtained:U,onSemanticObjectLinkNavigationPressed:R,onBeforeRebindChart:z1};}return B.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(C,o,s,h){q.extend(this,f(C,o,s,h));}});});
