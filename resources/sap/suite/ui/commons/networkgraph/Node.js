sap.ui.define(["jquery.sap.global","sap/suite/ui/commons/library","./ElementBase","sap/ui/core/IconPool"],function(q,l,E,I){var S=l.networkgraph.NodeShape;var H=32,T=5;var a={Circle:{WIDTH:96,HEIGHT:64},Box:{WIDTH:128,HEIGHT:32},Attributes:{LINE:16,OFFSET:8},ActionButtons:{RADIUS:13,MARGIN:8,OFFSET:4},Title:{LINESIZE:15,OFFSET:8,ICON_SIZE:16,INFO_BOX_SIZE:20,ICON_X_OFFSET:6,IMAGE_OFFSET_Y:6},Description:{LINESIZE:15},Image:{Box:16,Circle:32}};var b={EXPANDED:"Expanded",COLLAPSED:"Collapsed",PARTIAL:"Partial"};var A={EXPAND:"sys-add",COLLAPSE:"sys-minus",PARTIAL:"overlay"};var s=I.getIconInfo(A.EXPAND),c=I.getIconInfo(A.COLLAPSE),d=I.getIconInfo(A.PARTIAL);s=s&&s.content;c=c&&c.content;d=d&&d.content;var r=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var N=E.extend("sap.suite.ui.commons.networkgraph.Node",{metadata:{library:"sap.suite.ui.commons",properties:{collapsed:{type:"boolean",group:"Misc",defaultValue:false},selected:{type:"boolean",group:"Misc",defaultValue:false},group:{type:"string",group:"Misc",defaultValue:null},key:{type:"string",group:"Misc",defaultValue:null},shape:{type:"sap.suite.ui.commons.networkgraph.NodeShape",groups:"Behavior",defaultValue:S.Circle},icon:{type:"string",group:"Appearance",defaultValue:null},width:{type:"int",group:"Misc",defaultValue:undefined},height:{type:"int",group:"Misc",defaultValue:undefined},maxWidth:{type:"int",group:"Misc",defaultValue:undefined},x:{type:"float",group:"Misc",defaultValue:0},y:{type:"float",group:"Misc",defaultValue:0},showExpandButton:{type:"boolean",defaultValue:true},showActionLinksButton:{type:"boolean",defaultValue:true},showDetailButton:{type:"boolean",defaultValue:true},titleLineSize:{type:"int",defaultValue:1},descriptionLineSize:{type:"int",defaultValue:-1},iconSize:{type:"int",group:"Appearance",defaultValue:undefined}},aggregations:{actionLinks:{type:"sap.ui.core.Control",multiple:true,singularName:"actionLink"},actionButtons:{type:"sap.suite.ui.commons.networkgraph.ActionButton",multiple:true,singularName:"actionButton"},image:{type:"sap.suite.ui.commons.networkgraph.NodeImage",multiple:false,singularName:"nodeImage"}},events:{press:{},hover:{},collapseExpand:{}}},renderer:function(R,C){R.write(C._render());},onAfterRendering:function(){this._afterRenderingBase();}});N.prototype.aProcessRequiredProperties=["key","group"];N.prototype.init=function(o){this._oExpandState=b.EXPANDED;this._oGroup=null;this._iWidth=0;this._iHeight=0;this._iLabelAttrWidth=0;this._iValueAttrWidth=0;this._aTitleLines=[[]];this._aDescriptionLines=[[]];this._bIsHidden=false;this._bActionButtonsRendered=false;this._iCircleSize=0;this._aActionButtons=[];this._aActionButtonsClicks=[];this._clearChildren();};N.prototype._clearChildren=function(){this.aChildren=[];this.aParents=[];this.aLines=[];this.aParentLines=[];};N.prototype._afterRendering=function(){if(this._oGroup&&this._oGroup.getCollapsed()){return;}this._correctTitle("sapSuiteUiCommonsNetworkNodeTitle");this._setupEvents();if(this._bIsHidden){this.$().hide();}if(this._oExpandState===b.COLLAPSED){this.$().addClass("sapSuiteUiCommonsNetworkNodeCollapsed");}if(this._oExpandState===b.PARTIAL){this.$().addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");}this._bActionButtonsRendered=false;};N.prototype._render=function(o){var n="",i;if(this._isIgnored()||!this.getVisible()){return"";}o=o||{};i=o.mapRender?this.getId()+"_map":this.getId();n+=this._renderControl("g",{id:i,nodeid:this.getKey(),"class":this._getNodeClass()},false);n+=this._renderControl("g",{id:i+"-wrapper"},false);n+=this._renderContent(o);n+="</g>";n+="</g>";return n;};N.prototype._renderContent=function(o){var n=this._isBox()?this._renderBox(o):this._renderCircle();return n;};N.prototype._renderCircle=function(){var h="",x=this.getX(),y=this.getY(),e=4,i,f,C=this._iCircleSize,g=this.getParent()._bIsRtl,o=this.getImage(),j;h+=this._renderControl("circle",{id:this.getId()+"-innerBox",cx:x+this._iWidth/2,cy:y+C/2,style:this._getColorStyle({fill:E.ColorType.Background,stroke:E.ColorType.Border}),r:C/2,"class":"sapSuiteUiCommonsNetworkInnerCircle"});h+=this._renderControl("circle",{id:this.getId()+"-focusCircle",cx:x+this._iWidth/2,cy:y+C/2,style:this._getColorStyle({stroke:E.ColorType.Focus}),r:C/2-e,"class":"sapSuiteUiCommonsNetworkCircleFocus"});if(this._displayImage(o)){j=this._getImageSize();h+=this._renderControl("image",{"xlink:href":o.getSrc(),x:x+this._iWidth/2-j.width/2,y:y+C/2-j.height/2,width:j.width,height:j.height});}else if(this.getIcon()){h+=this._renderIcon({attributes:{"class":"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkCircleNodeIcon sapSuiteUiCommonsNetworkStatusText",style:(this.getIconSize()?("font-size:"+this.getIconSize()+"px;"):"")+this._getColorStyle({fill:E.ColorType.Content}),x:x+this._iWidth/2,y:y+C/2},icon:this.getIcon(),height:this.getIconSize()?this.getIconSize()-2:22});}if(this.getTitle()){if(!this._aTitleLines||this._aTitleLines.length===1){h+=this._renderClipPath({id:this.getId()+"-title-clip",x:x,y:y+C+a.Title.OFFSET-10,height:a.Title.LINESIZE*2});h+=this._renderTitle({"class":"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText",x:x+this._iWidth/2,y:y+C+a.Title.OFFSET,title:this.getTitle(),maxWidth:this._iWidth-5});}else{h+=this._renderMultilineTitle({x:x+this._iWidth/2,y:y+C+a.Title.OFFSET*2});}}if(this._displayDescription()){h+=this._renderDescription({x:g?x+this._iWidth-a.Title.OFFSET:x+a.Title.OFFSET,y:y+this._getTitleHeight()+C+a.Title.OFFSET*2+a.Title.OFFSET/2});}i=C/8;f=C/5.3;h+=this._renderInfoIcon(g?this._getCirclePosition().x+C-i:this._getCirclePosition().x+i,y+f);return h;};N.prototype._renderBox=function(o){var e=H/2,F=4,y=this.getY(),x=this.getX(),t=a.Title.ICON_X_OFFSET,i=this.getParent()._bIsRtl,f=this.getImage(),g,h=this._getImageSize();var j=this._renderControl("rect",{id:this.getId()+"-innerBox",x:x,y:y,style:this._getColorStyle({fill:E.ColorType.Background,stroke:E.ColorType.Border}),"class":"sapSuiteUiCommonsNetworkInnerRect",rx:5,ry:5,width:this._iWidth,height:this._iHeight,"pointer-events":"fill"});j+=this._renderControl("rect",{id:this.getId()+"-focusCircle",x:x+F,y:y+F,"class":"sapSuiteUiCommonsNetworkBoxFocus",style:this._getColorStyle({stroke:E.ColorType.Focus}),rx:5,ry:5,width:this._iWidth-F*2,height:this._iHeight-F*2});if(this._displayImage(f)){h=this._getImageSize();j+=this._renderControl("image",{"xlink:href":f.getSrc(),x:i?x+this._iWidth-a.Title.ICON_X_OFFSET-h.width:x+a.Title.ICON_X_OFFSET,y:y+a.Title.IMAGE_OFFSET_Y,width:h.width,height:h.height});t+=h.width+a.Title.ICON_X_OFFSET;}else if(this.getIcon()){j+=this._renderIcon({attributes:{style:this._getColorStyle({fill:E.ColorType.Content}),"class":"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeTitleIcon sapSuiteUiCommonsNetworkStatusText",x:i?x+this._iWidth-a.Title.ICON_X_OFFSET:x+a.Title.ICON_X_OFFSET,y:y+e},icon:this.getIcon(),height:a.Title.LINESIZE});t+=a.Title.ICON_SIZE+a.Title.ICON_X_OFFSET;}if(this.getTitle()){g=this._iWidth-t-T;if(g>0){if(!this._aTitleLines||this._aTitleLines.length===1){j+=this._renderClipPath({id:this.getId()+"-title-clip",x:x,y:y,height:H});j+=this._renderTitle({"class":"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText sapSuiteUiCommonsNetworkStatusText",style:this._getColorStyle({fill:E.ColorType.Content}),x:i?x+this._iWidth-t:x+t,y:y+e,maxWidth:g,title:this.getTitle()});}else{j+=this._renderMultilineTitle({x:i?x+this._iWidth-t:x+t,y:y+a.Title.OFFSET*2});}}}if(this._displayDescription()){j+=this._renderDescription({x:i?x+this._iWidth-a.Title.OFFSET:x+a.Title.OFFSET-a.Title.OFFSET/3,y:y+this._getTitleHeight()+(this._hasMultiLineTitle()?(a.Title.OFFSET*2+a.Title.OFFSET/2):a.Title.OFFSET*3)});}j+=this._renderInfoIcon(this.getParent()._bIsRtl?this.getX():this.getX()+this._iWidth-a.Title.INFO_BOX_SIZE,y);if(this._displayAttributes()){j+=o.sizeDetermination?this._renderAttributesForSize():this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+a.Title.OFFSET+(!this._hasMultiLineTitle()?a.Attributes.OFFSET:0)});}return j;};N.prototype._renderInfoIcon=function(x,y){var h="<g class=\"sapSuiteUiCommonsNetworkNodeInfoWrapper\">",i=this.getParent()._bIsRtl;if(this._isBox()){h+=this._renderRoundRect({"class":"sapSuiteUiCommonsNetworkNodeInfoBox",x:x,y:y,style:this._getColorStyle({fill:E.ColorType.Background,stroke:E.ColorType.Border}),width:a.Title.INFO_BOX_SIZE,height:a.Title.INFO_BOX_SIZE,topRight:i?0:5,topLeft:i?5:0,bottomLeft:i?0:8,bottomRight:i?8:0});}else{h+=this._renderControl("circle",{"class":"sapSuiteUiCommonsNetworkNodeInfoBox",cx:x,cy:y,style:this._getColorStyle({fill:E.ColorType.Background,stroke:E.ColorType.Border}),r:(a.Title.INFO_BOX_SIZE-1)/2});}h+=this._renderIcon({attributes:{"class":"sapSuiteUiCommonsNetworkNodeInfoIcon sapSuiteUiCommonsNetworkGraphIcon",x:x+a.Title.INFO_BOX_SIZE/2-(!this._isBox()?10:0),y:y+(this._isBox()?(a.Title.INFO_BOX_SIZE/2)-1:-0.5),style:this._getColorStyle({fill:E.ColorType.Content})},icon:"sap-icon://notification",height:a.Title.INFO_BOX_SIZE/2+2.5});h+="</g>";return h;};N.prototype._getNodeClass=function(){var e=this.getSelected()?this.SELECT_CLASS:"",C=this._hasCustomStatus()?" sapSuiteUiCommonsNetworkNodeCustomStatus ":"";return"sapSuiteUiCommonsNetworkNode "+e+C+(this._isBox()?" sapSuiteUiCommonsNetworkBox ":" sapSuiteUiCommonsNetworkNodeCircle ")+this._getStatusClass();};N.prototype._renderAttributesForSize=function(){var L="",v="";this.getVisibleAttributes().forEach(function(i){L+=this._renderText({attributes:{"class":"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:i.getLabel()});v+=this._renderText({attributes:{"class":"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:i.getValue()});},this);L="<g id=\""+this.getId()+"-attrLabel\">"+L+"</g>";v="<g id=\""+this.getId()+"-attrValue\">"+v+"</g>";return L+v;};N.prototype._renderAttributes=function(p){p=p||{};var P=2,B=6,D=12;var e=this.getParent()._bIsRtl,L=e?this.getX()+this._iWidth-B:this.getX()+B,f=this._iLabelAttrWidth?this._iLabelAttrWidth:this._iWidth/2-D,v=e?L-f-D:L+f+D,V=e?v-this.getX()-B:(this.getX()+this._iWidth)-v-B;var g=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false),h=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false),j=p.y,C=this._renderClipPath({id:this.getId()+"-clip-attr-label",x:e?L-f-B+P:L-P,y:j,width:P*2+(e?f+B:f)});C+=this._renderClipPath({id:this.getId()+"-clip-attr-value",x:e?this.getX()+B+P:v-P,y:j,width:P*2+(e?V+B:V)});this.getVisibleAttributes().forEach(function(o,i){var y=j+a.Attributes.LINE*(i+1);h+=this._renderText({attributes:{style:this._getColorStyle({fill:E.ColorType.Content}),"class":"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:L,y:y},text:o.getLabel()});g+=this._renderText({attributes:{style:this._getColorStyle({fill:E.ColorType.Content}),"class":"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:v,y:y},text:o.getValue()});},this);g+="</g>";h+="</g>";return C+h+g;};N.prototype._detailClick=function(o){o=o||this;this.getParent()._tooltip.openDetail({item:this,opener:o});};N.prototype._linksClick=function(o){o=o||this;this.getParent()._tooltip.openLink({item:this,opener:o});};N.prototype._expandClick=function(){var e=this.fireEvent("collapseExpand",{},true);if(e){this.setCollapsed(this._oExpandState!==b.COLLAPSED);}};N.prototype._applyMaxWidth=function(){var O=30,T=10;var n,$,e,v=0,L=0,i=0,f,m=this.getMaxWidth();if(this._oGroup&&this._oGroup.getCollapsed()){return;}if(!this.getWidth()&&this.getMaxWidth()){$=this.$("attrLabel");e=this.$("attrValue");if($[0]){L=$[0].getBBox().width;}if(e[0]){v=e[0].getBBox().width;}i=v+L+O;n=Math.max(this.$()[0].getBBox().width+T,i);this._iWidth=Math.min(n,m);if((v&&L)){f=Math.max(L,v);if(f*2+O/2<this._iWidth){return;}if(i>this._iWidth){if(v<m/2){this._iLabelAttrWidth=this._iWidth-v-O/2;}if(L<this._iWidth/2){this._iLabelAttrWidth=L+O/2;}}else{this._iLabelAttrWidth=this._iWidth-v-O;}}}};N.prototype._setupWidthAndHeight=function(){var t=this._isBox()?"Box":"Circle",i=this._getTitleHeight(),e=this.getTitle()||this._hasDetailData()?a.Title.LINESIZE:0,D=this._getDescriptionHeight(),h,w=a[t].WIDTH;if(!this._isBox()){h=this.getHeight()?this.getHeight():a.Circle.HEIGHT;this._iCircleSize=h;}else{h=D+(this._hasMultiLineTitle()?i+a.Title.OFFSET:Math.max(i+e,a.Box.HEIGHT));}if(this._displayAttributes()){h+=this.getVisibleAttributes().length*a.Attributes.LINE+a.Attributes.OFFSET;}if(!this._isBox()){h+=i+D;}this._iHeight=h;if(this.getWidth()){this._iWidth=this.getWidth();}else if(this._iWidth){if(this._iWidth<w){this._iWidth=w;}}else{this._iWidth=w;}if(!this._isBox()&&this._iWidth<this._iCircleSize){this._iWidth=this._iCircleSize;}};N.prototype._getTitleHeight=function(){var h=0,i=this._getImageSize();if(this._hasMultiLineTitle()){h=(((this.getTitleLineSize()>0)?Math.min(this._aTitleLines.length,this.getTitleLineSize()):this._aTitleLines.length))*a.Title.LINESIZE;}else{h=(this._isBox()||this.getTitle())?a.Title.LINESIZE:0;}return Math.max(i.height,h);};N.prototype._getDescriptionHeight=function(){var m=this.getDescriptionLineSize();if(m===-1||!this._aDescriptionLines||!this.getDescription()){return 0;}return(m>0?Math.min(m,this._aDescriptionLines.length):this._aDescriptionLines.length)*a.Description.LINESIZE;};N.prototype._setupEvents=function(){var $=this.$("wrapper");$.mousedown(function(e){this._mouseDown(e.ctrlKey);e.preventDefault();}.bind(this));$.mouseover(function(e){this._mouseOver();}.bind(this));$.mouseout(function(e){this._mouseOut();}.bind(this));};N.prototype._mouseOut=function(){this.$().removeClass(this.HIGHLIGHT_CLASS);if(!this.getSelected()){this._setStatusColors("");}};N.prototype._mouseOver=function(){var e=this.fireEvent("hover",{},true);if(!this.getSelected()&&e){this._setStatusColors("Hover");this.$().addClass(this.HIGHLIGHT_CLASS);}};N.prototype._mouseDown=function(i){var e=this.fireEvent("press",{},true);this.getParent()._selectNode({element:this,forceFocus:true,renderActionButtons:e&&!this.getSelected(),preventDeselect:i});if(!this.getSelected()){this.$().addClass(this.HIGHLIGHT_CLASS);}};N.prototype._deselect=function(){var $=this.$("innerBox");$.css("stroke",this._getColor(E.ColorType.Border));$.css("fill",this._getColor(E.ColorType.Background));};N.prototype._getExpandIcon=function(R){switch(this._oExpandState){case b.PARTIAL:return R?A.PARTIAL:d;case b.EXPANDED:return R?A.COLLAPSE:c;case b.COLLAPSED:return R?A.EXPAND:s;default:return R?A.EXPAND:s;}};N.prototype._createLineText=function(t,w,o,m){var L=[[]],i=0,R,W,e,f,g,h,j=this._createElement("tspan");if(!t||w<0){return L;}f=t.split(/\s+/).reverse();o.appendChild(j);while(f.length>0){W=f.pop();if(W){e=L[i];e.push(W);j.textContent=L[i].join(" ");if(j.getComputedTextLength()>w){if(e.length>1){f.push(e.pop());}if(e.length===1){h=this._createText(o,{text:e[0],width:w,dots:false});if(h){g=j.textContent;e.pop();e.push(g);R=W.substring(g.length);f.push(R);}}i++;if(m>0&&i>=m){break;}L[i]=[];}}}if(m>0&&f.length>0){L[L.length-1].push("...");}if(L.length>0){h=this._createText(o,{text:L[L.length-1].join(" "),width:w,dots:true});if(h){L[m-1]=[j.textContent];}}return L;};N.prototype._createDescription=function(){var t,w=this._iWidth-a.Title.OFFSET,$=this.$();if(this._displayDescription()&&$[0]){t=this._createElement("text");t.setAttribute("class","sapSuiteUiCommonsNetworkNodeDescription");t.setAttribute("style","font-size:0.75rem");$[0].appendChild(t);this._aDescriptionLines=this._createLineText(this.getDescription(),w,t,this.getDescriptionLineSize());}};N.prototype._createMultilineTitle=function(){var g=function(){if(this._isBox()){if(this._displayImage()){return this._iWidth-this._getImageSize().width-a.Title.ICON_X_OFFSET*2;}if(this.getIcon()){return this._iWidth-a.Title.ICON_SIZE-a.Title.ICON_X_OFFSET*2;}return this._iWidth-a.Title.OFFSET*2;}return this._iWidth;}.bind(this);var t,w=g(),$=this.$();if(this.getTitleLineSize()!==1&&$[0]&&w>0){t=this._createElement("text");t.setAttribute("class","sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle");t.setAttribute("style","font-size:0.75rem");$[0].appendChild(t);this._aTitleLines=this._createLineText(this.getTitle(),w,t,this.getTitleLineSize());}};N.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper");};N.prototype._renderMultilineText=function(m){var h="";if(!m.lines){return"";}for(var i=0;i<m.lines.length;i++){h+=this._renderText({attributes:{style:this._isBox()?this._getColorStyle({fill:E.ColorType.Content}):"","class":m.class+(this._isBox()?" sapSuiteUiCommonsNetworkStatusText ":""),x:m.x,y:m.y+(i*m.lineSize)},close:false});h+=m.lines[i].join(" ");h+="</text>";}return h;};N.prototype._renderDescription=function(m){m.class=" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle";return this._renderMultilineText({lines:this._aDescriptionLines,maxLineSize:this.getDescriptionLineSize(),lineSize:a.Description.LINESIZE,"class":" sapSuiteUiCommonsNetworkNodeDescription ",x:m.x,y:m.y});};N.prototype._renderMultilineTitle=function(m){return this._renderMultilineText({lines:this._aTitleLines,maxLineSize:this.getTitleLineSize(),lineSize:a.Title.LINESIZE,"class":" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle",x:m.x,y:m.y,trim:this._aTitleLines.length>this.getTitleLineSize()&&this.getTitleLineSize()!==0});};N.prototype._processHideShowParents=function(C,R,o){var i=this._oGroup&&this._oGroup.getCollapsed();var f=function(n){if(n._bIsHidden){return;}var h=false,e;if(n.getKey()!==R){if(n.aChildren.length>0){e=n.aChildren[0]._bIsHidden;n.aChildren.forEach(function(g){if(e!==g._bIsHidden){h=true;}});n._oExpandState=h?b.PARTIAL:e?b.COLLAPSED:b.EXPANDED;if(n._oExpandState===b.COLLAPSED){n.$().addClass("sapSuiteUiCommonsNetworkNodeCollapsed");}else{n.$().removeClass("sapSuiteUiCommonsNetworkNodeCollapsed");}if(n._oExpandState===b.PARTIAL){n.$().addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");}else{n.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");}}}};f(this);this.aParents.forEach(function(n){if(!o[n.getKey()]){f(n);}});if(i){if(this._oGroup._bNeedParentProcessing){this._oGroup.aNodes.forEach(function(g){g.aParents.forEach(function(p){if(!o[p.getKey()]){f(p);}});});this._oGroup._bNeedParentProcessing=false;}}};N.prototype._getAllChildren=function(C,R,o){var f=function(k){if(!o[k]){o[k]=this;return true;}return false;}.bind(this);if(R===this.getKey()){return;}if(this._bIsHidden===C){return;}if(!f(this.getKey())){return;}if(this._oGroup&&this._oGroup.getCollapsed()){this._oGroup.aNodes.forEach(function(n){n._getAllChildren(C,R,o);});}if(this._oExpandState!==b.COLLAPSED){this.aChildren.forEach(function(n){n._getAllChildren(C,R,o);});}};N.prototype._hideShow=function(C,R){var h=function(g){return g.aNodes.some(function(n){return!n._bIsHidden;});};var f=C?"hide":"show",e;this._bIsHidden=C;this.aLines.forEach(function(L){L._hideShow(C);});this.aParentLines.forEach(function(L){L._hideShow(C,R);});if(this.$()){this.$()[f]();}if(this._oGroup){if(this._oGroup.getCollapsed()){this._oGroup._hideShow(C,R);}else{e=h(this._oGroup);if((e&&!C)||(!e&&C)){this._oGroup.$()[f]();this._oGroup._bIsHidden=C;}}}};N.prototype._setActionButtonFocus=function(i,f){this.$().removeClass(this.FOCUS_CLASS);this.$().find(".sapSuiteUiCommonsNetworkNodeActionButton").parent().removeClass(this.FOCUS_CLASS);var F=f?"addClass":"removeClass";q(i)[F](this.FOCUS_CLASS);};N.prototype._getActionButtonTitle=function(i){return r.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+" "+q(i).find("title").html();};N.prototype._getAccessibilityLabel=function(){var L=r.getText("NETWORK_GRAPH_NODE")+" "+this.getTitle();if(this._isBox()){this.getVisibleAttributes().forEach(function(o){L+=" "+o.getLabel()+" "+o.getValue();});}return L;};N.prototype._setStatusColors=function(t){if(this._hasCustomStatus()){var $=this.$("innerBox"),C=this._getColor(E.ColorType[t+"Content"]),B=this._getColor(E.ColorType[t+"Background"]),e=this._getColor(E.ColorType[t+"Border"]),f=this.$().find(".sapSuiteUiCommonsNetworkNodeInfoBox");$.css("fill",B);$.css("stroke",e);this.$().find(".sapSuiteUiCommonsNetworkStatusText").css("fill",C);f.css("fill",B);f.css("stroke",e);this.$().find(".sapSuiteUiCommonsNetworkNodeInfoIcon").css("fill",C);this.$("focusCircle").css("stroke",this._getColor(E.ColorType[t+"Focus"]));}};N.prototype.hasVisibleActionButtons=function(){return this.$().hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS);};N.prototype.getEnabledActionButtons=function(){return this.$().find(".sapSuiteUiCommonsNetworkNodeActionButton").parent().toArray();};N.prototype.showActionButtons=function(e){var R,f,t=this,B=0,M=4,w,o,g,h,m,L;var C=function(){var g=this.getParent()._bIsRtl?-a.ActionButtons.RADIUS-a.ActionButtons.MARGIN:a.ActionButtons.RADIUS+a.ActionButtons.MARGIN,h=a.ActionButtons.RADIUS,p=[[g,h]];for(var i=1;i<R;i++){p.push([g,h+a.ActionButtons.RADIUS*2*i+a.ActionButtons.OFFSET*i]);}return p;}.bind(this);var G=function(){var k=this.getActionButtons().length;if(this.getShowExpandButton()){k++;}if(this.getShowDetailButton()){k++;}if(this.getShowActionLinksButton()){k++;}return k;}.bind(this);var j=function(k){var n=13,p=2;var u={cx:k.x,cy:k.y,id:k.id+"-circle","class":"sapSuiteUiCommonsNetworkNodeActionButton",r:a.ActionButtons.RADIUS},v={"class":"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeActionIcon "+(k.class?k.class:""),x:k.x,y:k.y},x,y,z,D,J,$;if(!k.enable){u.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabledBackground";w.appendChild(this._createElement("circle",u));u.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabled";v.class+=" sapSuiteUiCommonsNetworkNodeActionButtonDisabled";}J=this._createElement("g",{id:k.id});x=this._createElement("circle",{id:k.id+"-circle",cx:k.x,cy:k.y,r:a.ActionButtons.RADIUS-p,"class":"sapSuiteUiCommonsNetworkActionButtonFocusCircle"});z=this._createElement("circle",u);D=this._createIcon(v,k.icon,n);if(k.title){y=this._createElement("title");y.textContent=k.title;z.appendChild(y);}J.appendChild(z);J.appendChild(D);J.appendChild(x);w.appendChild(J);$=q(z);if(k.enable){$.mousedown(function(){$.addClass("sapSuiteUiCommonsNetworkNodeActionButtonClicked");this._setActionButtonFocus(J,true);this._setFocus(false);if(this.getParent()){this.getParent().setFocus({item:this,button:J});}}.bind(this));$.mouseup(function(){$.removeClass("sapSuiteUiCommonsNetworkNodeActionButtonClicked");});q(z).click(k.click);this._aActionButtonsClicks.push(k.click);}this._aActionButtons.push(J);B++;return{icon:D,wrapper:z};}.bind(this);var F=e?"addClass":"removeClass";this.$()[F](this.VISIBLE_ACTIONS_BUTTONS_CLASS);R=G();f=C();if(R===0){return;}if(e&&!this._bActionButtonsRendered){this._aActionButtons=[];this._aActionButtonsClicks=[];g=this.getX();h=this.getY();if(!this.getParent()._bIsRtl){g+=(this._isBox()?this._iWidth:this._iWidth/2+this._iCircleSize/2);}else if(!this._isBox()){g+=this._iWidth/2-this._iCircleSize/2;}w=this._createElement("g",{"class":"sapSuiteUiCommonsNetworkNodeActionButtonWrapper",id:this._getDomId("actionButtons")});this.$()[0].appendChild(w);if(this.getShowExpandButton()){o=j({x:g+f[B][0],y:h+f[B][1],icon:this._getExpandIcon(true),"class":"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",enable:this._hasVisibleChildren(),title:r.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)});this._expandIcon=o.icon;}if(this.getShowDetailButton()){m=j({x:g+f[B][0],y:h+f[B][1],icon:"sap-icon://menu",enable:this._hasDetailData()||this.getTitle(),id:this._getDomId("actionDetail"),title:r.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(){this._detailClick(m.wrapper);}.bind(this)});}if(this.getShowActionLinksButton()){L=j({x:g+f[B][0],y:h+f[B][1],icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:r.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(){this._linksClick(L.wrapper);}.bind(this)});}for(var i=0;B<M&&i<this.getActionButtons().length;i++){(function(k){var n=j({x:g+f[B][0],y:h+f[B][1],icon:k.getIcon(),title:k.getTitle(),id:k.getId(),click:function(p){k.firePress({buttonElement:n.wrapper});},enable:true});})(this.getActionButtons()[i]);}this._bActionButtonsRendered=true;}else if(this._expandIcon){this._expandIcon.textContent=t._getExpandIcon();this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);}};N.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren;};N.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines;};N.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents;};N.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines;};N.prototype.isHidden=function(){return this._bIsHidden;};N.prototype.getCenterPosition=function(){var C,o;if(this._isBox()){return{x:this.getX()+this._iWidth/2,y:this.getY()+this._iHeight/2};}C=this._getCirclePosition();o=this._getCircleSize()/2;return{x:C.x+o,y:C.y+o};};N.prototype.setX=function(x){this.setProperty("x",x,true);return this;};N.prototype.setY=function(y){this.setProperty("y",y,true);return this;};N.prototype.setSelected=function(e){var p=this.getParent(),f=e?"addClass":"removeClass",k=this.getKey();this._setStatusColors(e?"Selected":"");this.setProperty("selected",e,true);this.$()[f](this.SELECT_CLASS);if(p){if(e){p._mSelectedNodes[k]=this;}else{delete p._mSelectedNodes[k];}}return this;};N.prototype.setCollapsed=function(C){var o={},e,p,f=C?"addClass":"removeClass",$=this.$().find(".sapSuiteUiCommonsNetworkNodeActionCollapseIcon");this.setProperty("collapsed",C,true);this._oExpandState=C?b.COLLAPSED:b.EXPANDED;this.aChildren.forEach(function(n){n._getAllChildren(C,this.getKey(),o);},this);e=Object.keys(o);e.forEach(function(k){o[k]._hideShow(C,this.getKey());},this);e.forEach(function(k){o[k]._processHideShowParents(C,this.getKey(),o);},this);this.aLines.forEach(function(L){L._hideShow(C);});if($[0]){$[0].textContent=this._getExpandIcon();}this.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");this.$()[f]("sapSuiteUiCommonsNetworkNodeCollapsed");p=this.getParent();if(p){p._setupKeyboardNavigation();if(C&&!(p.getFocus()&&p.getFocus().item===this)){p.setFocus({item:this});}}return this;};N.prototype.setGroup=function(g){var p=this.getParent();this.setProperty("group",g,true);if(p){p.invalidate();}return this;};N.prototype.setShape=function(e){var p=this.getParent();this.setProperty("shape",e,true);if(p){p.invalidate();}return this;};N.prototype.setWidth=function(w){var p=this.getParent();this.setProperty("width",w,true);if(p){p.invalidate();}return this;};N.prototype.setMaxWidth=function(m){var p=this.getParent();this.setProperty("maxWidth",m,true);if(p){p.invalidate();}return this;};N.prototype.setTitleLineSize=function(t){var p=this.getParent();this.setProperty("titleLineSize",t,true);if(p){p.invalidate();}return this;};N.prototype._isIgnored=function(){return(this.getParent()._getLayoutAlgorithm().isLayered()&&this._oGroup&&(this._oGroup.getCollapsed()||this._oGroup._isIgnored()))||!this._useInLayout();};N.prototype._getImageSize=function(){var R=function(w,h){return{width:w?parseInt(w,10):0,height:h?parseInt(h,10):0};};var t=this._isBox()?"Box":"Circle",i=this.getImage();if(!this._displayImage(i)){return R();}return R(i.getWidth()?i.getWidth():a.Image[t],i.getHeight()?i.getHeight():a.Image[t]);};N.prototype._displayImage=function(i){i=i||this.getImage();return i&&i.getSrc();};N.prototype._isInCollapsedGroup=function(){return this._oGroup&&this._oGroup.getCollapsed();};N.prototype._displayAttributes=function(){return this.getVisibleAttributes().length!==0&&this._isBox();};N.prototype._displayDescription=function(){return this.getDescriptionLineSize()!==-1&&this.getDescription();};N.prototype._hasTitle=function(){return this.getTitle()||this.getIcon();};N.prototype._isBox=function(){return this.getShape()===S.Box&&this.getParent()._getLayoutAlgorithm().isLayered();};N.prototype._hasChildren=function(){return this.aChildren.length>0;};N.prototype._hasVisibleChildren=function(){return this.aChildren.some(function(n){return!(n._oGroup&&!n._oGroup.getVisible())&&n.getVisible();});};N.prototype._hasDetailData=function(){return this.getDescription()||this.getAttributes().length>0;};N.prototype._hasActionLinks=function(){return this.getActionLinks().some(function(L){return L.getVisible();});};N.prototype._useAutomaticSize=function(){return!this.getWidth()&&this.getMaxWidth()>0;};N.prototype._getCircleSize=function(){return this._isBox()?undefined:this._iCircleSize;};N.prototype._hasMultiLineTitle=function(){return this._aTitleLines&&this._aTitleLines.length>1;};N.prototype._getCirclePosition=function(){return this._isBox()?undefined:{x:this.getX()+(this._iWidth-this._getCircleSize())/2,y:this.getY()};};N.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper");};return N;});
