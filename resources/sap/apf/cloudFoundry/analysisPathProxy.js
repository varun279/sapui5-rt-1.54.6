/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define([],function(){'use strict';var A=function(i){var m=i.instances.messageHandler;var c=i.instances.coreApi;var a=i.manifests.manifest;var d=a["sap.app"].dataSources;var b=d&&d["apf.runtime.analysisPaths"]&&d["apf.runtime.analysisPaths"].uri;var e={"Content-Type":"application/json; charset=utf-8"};this.openPath=function(n,o){var u=b+"/"+n+"?$select=AnalysisPathName,SerializedAnalysisPath";l({method:"GET",url:u,dataType:"json",success:function(r){var p={AnalysisPathName:r.analysisPath.analysisPathName,SerializedAnalysisPath:JSON.parse(r.analysisPath.serializedAnalysisPath)};o({path:p,status:"successful"},g());},error:function(p,t,q,M){var r=f(p,"5252",[n],M,m);m.putMessage(r);},headers:e});};this.createPath=function(n,o,s){var p=j();if(p===undefined){o({status:"failed"},undefined,m.createMessageObject({code:5075}));return;}var q=k(s);var r={analysisPathName:n,analyticalConfiguration:p,structuredAnalysisPath:JSON.stringify(q),serializedAnalysisPath:JSON.stringify(s)};l({method:"POST",url:b,data:JSON.stringify(r),dataType:"json",success:function(t){o({AnalysisPath:t.analysisPath,status:"successful"},g());},error:function(t,u,v,M){var w=h(t,M,m);o({status:"failed"},undefined,w);},headers:e});};this.modifyPath=function(n,o,p,s){var q=k(s);var r={analysisPathName:o,structuredAnalysisPath:JSON.stringify(q),serializedAnalysisPath:JSON.stringify(s)};l({method:"PUT",url:b+"/"+n,data:JSON.stringify(r),dataType:"json",success:function(){p({AnalysisPath:n,status:"successful"},g());},error:function(t,u,v,M){var w=h(t,M,m);p({status:"failed"},undefined,w);},headers:e});};this.deletePath=function(n,o){l({method:"DELETE",url:b+"/"+n,success:function(){o({status:"successful"},g());},error:function(p,t,q,M){var r=h(p,M,m);o({status:"failed"},undefined,r);}});};this.readPaths=function(n){function t(r){var p=[];if(r.analysisPaths!==null){r.analysisPaths.forEach(function(q){p.push({AnalysisPath:q.analysisPath,AnalysisPathName:q.analysisPathName,LastChangeUTCDateTime:q.lastChangeUtcDateTime,StructuredAnalysisPath:JSON.parse(q.structuredAnalysisPath)});});}return p;}var o=j();if(o===undefined){n({status:"failed"},undefined,m.createMessageObject({code:5075}));return;}var u=b+"?$select=AnalysisPath,AnalysisPathName,LastChangeUtcDateTime,StructuredAnalysisPath&$filter=(AnalyticalConfiguration%20eq%20'"+o+"')";l({url:u,dataType:"json",success:function(r){var p=t(r);n({paths:p,status:"successful"},g());},error:function(p,q,r,M){var s=h(p,M,m);n({status:"failed"},undefined,s);},headers:e});};function g(){return undefined;}function f(n,o,p,q,m){var r=m.createMessageObject({code:o,aParameters:p});var t=h(n,q,m);r.setPrevious(t);return r;}function h(n,p,m){var t=m.createMessageObject({code:"5214",aParameters:[n.status,n.statusText]});if(p){t.setPrevious(p);}return t;}function j(){var n=c.getStartParameterFacade().getAnalyticalConfigurationId();return n&&n.configurationId;}function k(s){var n=[];var o=s.path.steps;o.forEach(function(p){n.push({stepId:p.stepId,selectedRepresentationId:p.binding.selectedRepresentationId});});return{steps:n,indexOfActiveStep:s.path.indicesOfActiveSteps[0]};}function l(n){i.instances.ajaxHandler.send(n);}};sap.apf=sap.apf||{};sap.apf.cloudFoundry=sap.apf.cloudFoundry||{};sap.apf.cloudFoundry.AnalysisPathProxy=A;return A;},true);
