sap.ui.define(["jquery.sap.global","sap/ui/base/EventProvider"],function(q,E){"use strict";var R=E.extend("sap.ui.vk.tools.RectSelectToolHandler",{metadata:{publicMethods:["beginGesture","endGesture","move","click","doubleClick","contextMenu"]},constructor:function(T){this._tool=T;this._rect=null;this._gesture=false;this._nomenu=false;this._selectionRect=null;}});R.prototype.destroy=function(){this._tool=null;this._rect=null;this._gesture=false;};R.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};R.prototype._inside=function(e){var i=this._tool._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};R.prototype.beginGesture=function(e){if(this._inside(e)&&!this._gesture){this._gesture=true;e.handled=true;var x=e.x-this._rect.x,y=e.y-this._rect.y;this._selectionRect={x1:x,y1:y,x2:x,y2:y};return;}};R.prototype.move=function(e){if(this._gesture){e.handled=true;this._nomenu=true;var x=e.x-this._rect.x,y=e.y-this._rect.y;if(this._selectionRect){this._selectionRect.x2=x;this._selectionRect.y2=y;if(this.getViewport()){this.getViewport().setSelectionRect(this._selectionRect);}return;}}};R.prototype.click=function(e){e.handled=false;};R.prototype.doubleClick=function(e){e.handled=false;};R.prototype.contextMenu=function(e){e.handled=false;};R.prototype.endGesture=function(e){if(this._gesture){this._gesture=false;e.handled=true;var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug("Loco: endGesture: "+x+", "+y);if(this._selectionRect){this._selectionRect.x2=x;this._selectionRect.y2=y;this._executeRectSelect(this._selectionRect.x1,this._selectionRect.y1,this._selectionRect.x2,this._selectionRect.y2);if(this.getViewport()){this.getViewport().setSelectionRect(null);}this._selectionRect=null;return;}}};R.prototype._executeRectSelect=function(a,b,c,d){if(this._inside(event)&&!this._gesture){this._gesture=false;var x=event.x-this._rect.x,y=event.y-this._rect.y;this._gizmo=this._tool.getGizmo();if(this._gizmo){this._gizmo.show(this._tool._viewport);this._gizmo.moveGizmo(x,y);}var s=this._tool._viewport.getScene();var e=this._tool._viewport.getCamera();this._tool.select(a,b,c,d,s,e);if(this._gizmo){this._gizmo.hide();}}};R.prototype.getViewport=function(){return this._tool._viewport;};return R;},true);
