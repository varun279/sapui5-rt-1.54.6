var XLSXExportUtils=function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=31)}({31:function(e,t,n){var r=n(32),a=n(34);e.exports={oData:{fetch:r.requestData,getConverter:r.getConverter},saveFile:a.saveFile}},32:function(e,t,n){function r(e){var t,n,r;return null==e?null:("object"==typeof e&&(e=e.valueOf()),"number"==typeof e?e:f.test(e)?(t=f.exec(e),n=new Date(parseInt(t[1],10)),t[2]&&t[3]&&(r=parseInt(t[2]+t[3],10),n.setUTCMinutes(n.getUTCMinutes()-r)),n.getTime()):isFinite(e)?parseInt(e,10):(n=new Date(e),isFinite(n)?n.getTime():null))}function a(e){if(e instanceof Date)return e.getTime();if(e&&"Edm.Time"===e.__edmType)return e.ms;if("string"==typeof e&&l.test(e)){var t=l.exec(e),n=t[2]||"0",r=t[3]||"0",a=parseInt(t[4]||0,10),o=parseInt(t[5]||0,10),i=parseInt(t[6]||0,10),s=parseFloat(t[7]||0);if("0"!==n||"0"!==r)return e;var u=t[8];u=u?1e3*parseFloat("0."+u):0,u+=1e3*s+6e4*i+36e5*o+864e5*a,"-"===t[1]&&(u=-u),e=u}return e}function o(e,t){var n=t.keys.reduce(function(e,t){return e&&e[t]},e);return n&&("date"===t.type||"datetime"===t.type?n=r(n):"time"===t.type&&(n=a(n))),n}function i(e,t){return t.forEach(function(t){e.forEach(function(e){e[t.property]=o(e,t)})}),e}function s(e){return e.workbook.columns.reduce(function(e,t){return(t.property instanceof Array?t.property:[t.property]).forEach(function(n){var r=n.split("/");(r.length>1||"date"===t.type||"datetime"===t.type||"time"===t.type)&&e.push({property:n,keys:r,type:t.type})}),e},[])}function u(e){var t=s(e);return function(e){return i(e,t)}}function c(e,t){function n(e,t,n){var r=URI.parse(h);if(n){var a=URI.parse(n);r.query=a.query}else{var o=(r.query||"").split("&"),i={};o.forEach(function(e){var t=e.split("=");t[0]&&(i[t[0]]=t[1])}),i.$skip=e,i.$top=t,o=[];for(var s in i)o.push(s+(null==i[s]?"":"="+i[s]));r.query=o.join("&")}return(URI.serialize||URI.build)(r)}function r(e){t({error:e})}function a(e){var s,u,d,h,v,y={};l||(s=e&&e.d&&(e.d.results||e.d)||e,s=Array.isArray(s)?s:[],d=s.length,i+=d,v=c-i,h=i/c,y.finished=0===d||v<=0,y.progress=Math.round(100*h),u=e&&e.d&&e.d.__next||null,y.finished||(o.dataUrl=n(i,Math.min(f,v),u),p.sendRequest(o).then(a).catch(r)),y.rows=x(s),t(y))}var o,i=0,s=e.dataSource,c=Math.min(s.count||d,d),f=Math.min(s.sizeLimit||d,e.batchSize||d,c),l=!1,h=s.dataUrl,x=u(e);return o={serviceUrl:function(e){if(!e)return"";var t=URI.parse(e);return t.path=t.path||"","/"!==t.path.slice(-1)&&(t.path=t.path+"/"),delete t.query,delete t.hash,delete t.fragment,(URI.serialize||URI.build)(t)}(s.serviceUrl),dataUrl:n(0,f),method:s.useBatch?"BATCH":"GET",headers:s.headers},p.sendRequest(o).then(a).catch(r),{cancel:function(){l=!0}}}var p=n(33),d=1e6,f=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,l=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/;e.exports={requestData:c,getConverter:u}},33:function(e,t){function n(e){if("object"!=typeof e||null===e||"string"!=typeof e.dataUrl)throw new Error("Unable to send request - Mandatory parameters missing.");return("BATCH"===e.method&&e.serviceUrl?o:r)(e)}function r(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.onload=function(){if(this.status>=400)return void n(this.responseText);try{t(JSON.parse(this.responseText))}catch(e){n(s+this.responseText)}},r.onerror=function(){n(i)},r.onabort=function(){n(i)},r.open("GET",e.dataUrl,!0),r.setRequestHeader("accept","application/json"),r.send()})}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function o(e){return new Promise(function(t,n){var r=new XMLHttpRequest,o="batch_"+a(),u=e.dataUrl.split(e.serviceUrl)[1],c=[];r.onload=function(){for(var e=this.responseText,r=this.responseText.split("\r\n"),a=0,o=r.length,i=o-1;a<o&&"{"!==r[a].slice(0,1);)a++;for(;i>0&&"}"!==r[i].slice(-1);)i--;r=r.slice(a,i+1),e=r.join("\r\n");try{var u=JSON.parse(e);t(u)}catch(t){n(s+e)}},r.onerror=function(){n(i)},r.onabort=function(){n(i)},r.open("POST",e.serviceUrl+"$batch",!0),r.setRequestHeader("Accept","multipart/mixed"),r.setRequestHeader("Content-Type","multipart/mixed;boundary="+o);for(var p in e.headers)"accept"!=p.toLowerCase()&&r.setRequestHeader(p,e.headers[p]);c.push("--"+o),c.push("Content-Type: application/http"),c.push("Content-Transfer-Encoding: binary"),c.push(""),c.push("GET "+u+" HTTP/1.1");for(var p in e.headers)c.push(p+":"+e.headers[p]);c.push(""),c.push(""),c.push("--"+o+"--"),c.push(""),c=c.join("\r\n"),r.send(c)})}var i="HTTP connection error",s="Unexpected server response:\n";e.exports={sendRequest:n}},34:function(e,t){function n(e,t){var n,r,a;e instanceof Blob&&(n=document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,r&&(a=function(e,t){n.download=t,n.href=URL.createObjectURL(e),n.dispatchEvent(new MouseEvent("click"))}),void 0===a&&(a=function(t){var n=new FileReader;n.onloadend=function(){var e,t;t=n.result.replace(/^data:[^;]*;/,"data:attachment/file;"),(e=window.open(t,"_blank"))||(window.location.href=t)},n.readAsDataURL(e)}),"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&(a=function(e,t){window.navigator.msSaveOrOpenBlob(e,t)}),a(e,t))}e.exports={saveFile:n}}});
