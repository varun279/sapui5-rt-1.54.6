/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2018 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/ui/mdc/library','sap/ui/core/Control','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver','sap/ui/model/BindingMode'],function(q,l,C,M,a,B){"use strict";var T;var L;var I;var b;var D;var c;var d;var E=l.EditMode;var F=l.FieldDisplay;var e=C.extend("sap.ui.mdc.base.Field",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{value:{type:"any",defaultValue:null},additionalValue:{type:"any",defaultValue:null},dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:""},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:F.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.base.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.base.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{change:{parameters:{value:{type:"string"},valid:{type:"boolean"}}},liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},dataChanged:{},press:{}},publicMethods:[],defaultAggregation:"content",defaultProperty:"value"},_oManagedObjectModel:null});e.prototype.init=function(){this._oManagedObjectModel=new M(this);this._oObserver=new a(z.bind(this));this._oObserver.observe(this,{properties:["value","additionalValue","display","editMode","dataType","multipleLines"],aggregations:["fieldInfo","content"],associations:["fieldHelp"]});this._oDatePickerRequested={};};e.prototype.exit=function(){this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;};e.prototype.onBeforeRendering=function(){f.call(this);};e.prototype.onAfterRendering=function(){if(R.call(this)&&this.getEditMode()!=E.Display){var Z=this.getAggregation("_content");if(Z){var $=Z.getFocusDomRef();q($).attr("autocomplete","off");}}};e.prototype.onfocusin=function(Z){Y.call(this);};function _(Z){if(!this.isBound("additionalValue")){var $=R.call(this);var a1=this.getAggregation("_content");if($&&this.getDisplay()==sap.ui.mdc.FieldDisplay.Description&&!$.getFilterValue()&&(!a1||a1.getDOMValue())){var b1;if(Z){b1=$.getTextForKey(Z);if(this._bConnected){$.setSelectedKey(Z);}this.setAdditionalValue(b1);}}}}e.formatText=J;function f(){if(!this._getContent()){var Z=this.getEditMode();var $=this.getDataType();var a1;var b1=this.getId()+"-inner";switch(Z){case E.Display:var d1=this.getFieldInfo();if(d1){if(d1.isTriggerable()){$="Link";}else if($=="Link"){$="";}}switch($){case"Edm.Date":case"Edm.DateTimeOffset":case"Edm.TimeOfDay":a1=g.call(this,b1,{path:"$field>value",type:this._getDataType()},false);break;case"Link":a1=i.call(this,b1);break;default:a1=g.call(this,b1,"{$field>/@custom/formattedValue}",this.getMultipleLines());break;}break;default:switch($){case"Edm.Date":a1=r.call(this,b1);break;case"Edm.DateTimeOffset":a1=t.call(this,b1);break;case"Edm.TimeOfDay":a1=v.call(this,b1);break;default:var c1="$field>value";if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){c1="$field>additionalValue";}if(this.getMultipleLines()&!R.call(this)){a1=n.call(this,b1,c1);}else{a1=k.call(this,b1,c1);}break;}break;}if(a1){this.setAggregation("_content",a1);K.call(this,a1);}}}function g(Z,$,a1){var b1;if(!T&&!this._bTextRequested){T=sap.ui.require("sap/m/Text");if(!T){sap.ui.require(["sap/m/Text"],h.bind(this));this._bTextRequested=true;}}if(T){b1=new T(Z,{text:$,textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",wrapping:a1,width:"100%"});}return b1;}function h(Z){T=Z;this._bTextRequested=false;f.call(this);}function i(Z){var $;if(!L&&!this._bLinkRequested){L=sap.ui.require("sap/m/Link");if(!L){sap.ui.require(["sap/m/Link"],j.bind(this));this._bLinkRequested=true;}}if(L){var a1="{$field>additionalValue}";var b1=this.getFieldInfo();if(b1){a1=b1.getTriggerHref();}$=new L(Z,{text:"{$field>value}",href:a1,textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",width:"100%",press:P.bind(this)});}return $;}function j(Z){L=Z;this._bLinkRequested=false;f.call(this);}function k(Z,$){var a1;if(!I&&!this._bInputRequested){I=sap.ui.require("sap/m/Input");if(!I){sap.ui.require(["sap/m/Input"],m.bind(this));this._bInputRequested=true;}}if(I){a1=new I(Z,{value:{path:$},placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:x},enabled:{path:"$field>editMode",formatter:y},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",showValueHelp:!!this.getFieldHelp(),width:"100%",change:N.bind(this),liveChange:O.bind(this),valueHelpRequest:Q.bind(this)});}return a1;}function m(Z){I=Z;this._bInputRequested=false;f.call(this);}function n(Z,$){var a1;if(!b&&!this._bTextAreaRequested){b=sap.ui.require("sap/m/TextArea");if(!b){sap.ui.require(["sap/m/TextArea"],o.bind(this));this._bTextAreaRequested=true;}}if(b){a1=new b(Z,{value:{path:$},placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:x},enabled:{path:"$field>editMode",formatter:y},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",width:"100%",change:N.bind(this),liveChange:O.bind(this)});}return a1;}function o(Z){b=Z;this._bTextAreaRequested=false;f.call(this);}function p(Z,$,a1,b1){var c1;if(!Z&&!this._oDatePickerRequested[$]){Z=sap.ui.require($);if(!Z){sap.ui.require([$],a1.bind(this));this._oDatePickerRequested[$]=true;}}if(Z){c1=new Z(b1,{value:{path:"$field>value",type:this._getDataType()},placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:x},enabled:{path:"$field>editMode",formatter:y},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",width:"100%",change:N.bind(this)});}return c1;}function r(Z){return p.call(this,D,"sap/m/DatePicker",s,Z);}function s(Z){D=Z;this._oDatePickerRequested["sap/m/DatePicker"]=false;f.call(this);}function t(Z){return p.call(this,c,"sap/m/DateTimePicker",u,Z);}function u(Z){c=Z;this._oDatePickerRequested["sap/m/DateTimePicker"]=false;f.call(this);}function v(Z){return p.call(this,d,"sap/m/TimePicker",w,Z);}function w(Z){d=Z;this._oDatePickerRequested["sap/m/TimePicker"]=false;f.call(this);}e.prototype._getContent=function(){return this.getContent()||this.getAggregation("_content");};function x(Z){if(Z&&Z==E.Editable){return true;}else{return false;}}function y(Z){if(Z&&Z!=E.Disabled){return true;}else{return false;}}function z(Z){if(Z.name=="value"||Z.name=="additionalValue"||Z.name=="display"){var $=J(this.getValue(),this.getAdditionalValue(),this.getDisplay());this._oManagedObjectModel.setProperty("/@custom/formattedValue",$);}if(Z.name=="value"||Z.name=="display"){_.call(this,this.getValue());}if(Z.name=="editMode"){if(Z.old!=Z.current){if(this.getAggregation("_content")){this.destroyAggregation("_content");f.call(this);}}}if(Z.name=="multipleLines"){if(Z.old!=Z.current){if(this.getAggregation("_content")){this.destroyAggregation("_content");f.call(this);}}}if(Z.name=="dataType"){if(Z.old!=Z.current){delete this._oDataType;if(this.getAggregation("_content")){this.destroyAggregation("_content");f.call(this);}}}if(Z.name=="fieldHelp"&&Z.ids){A.call(this,Z.ids,Z.mutation);}if(Z.name=="fieldInfo"&&Z.child){G.call(this,Z.child,Z.mutation);}if(Z.name=="content"&&Z.child){H.call(this,Z.child,Z.mutation);}}function A(Z,$){var a1=R.call(this);var b1=false;if($=="remove"){a1.detachEvent("select",S,this);a1.detachEvent("navigate",U,this);a1.detachEvent("dataUpdate",V,this);a1.detachEvent("disconnect",X,this);}else if($=="insert"){if(a1){a1.attachEvent("dataUpdate",V,this);_.call(this,this.getValue());}b1=true;}var c1=this.getAggregation("_content");if(c1&&c1.setShowValueHelp){c1.setShowValueHelp(b1);}}function G(Z,$){if($=="remove"){Z.detachEvent("dataUpdate",W,this);if(this.getAggregation("_content")){this.destroyAggregation("_content");f.call(this);}}else if($=="insert"){Z.attachEvent("dataUpdate",W,this);W.call(this);}}function H(Z,$){if($=="remove"){Z.unbindElement("$field");if(Z.getMetadata().getEvents().change){Z.detachEvent("change",N,this);}if(Z.getMetadata().getEvents().liveChange){Z.detachEvent("liveChange",O,this);}if(Z.getMetadata().getEvents().press){Z.detachEvent("press",P,this);}}else if($=="insert"){K.call(this,Z);if(Z.getMetadata().getEvents().change){Z.attachEvent("change",N,this);}if(Z.getMetadata().getEvents().liveChange){Z.attachEvent("liveChange",O,this);}if(Z.getMetadata().getEvents().press){Z.attachEvent("press",P,this);}if(this.getAggregation("_content")){this.destroyAggregation("_content");}}}function J(Z,$,a1){var b1=Z?Z:"";var c1=$?$:"";var d1="";switch(a1){case F.Description:d1=c1;break;case F.ValueDescription:d1=b1+" ("+c1+")";break;case F.DescriptionValue:d1=c1+" ("+b1+")";break;default:d1=b1;}if(d1.replace){d1=d1.replace(" ()","");}return d1;}function K(Z){Z.setModel(this._oManagedObjectModel,"$field");Z.bindElement({path:"/",model:"$field"});}function N(Z){var $;var a1=true;if("value"in Z.getParameters()){$=Z.getParameter("value");}else{$=this.getValue();}if("valid"in Z.getParameters()){a1=Z.getParameter("valid");}var b1=R.call(this);if(b1){b1.close();b1.setFilterValue("");if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){$=b1.getKeyForText($);if(this._bConnected){b1.setSelectedKey($);}this.setProperty("value",$,true);}}this.fireChange({value:$,valid:a1});}function O(Z){var $;var a1;var b1=false;if("value"in Z.getParameters()){$=Z.getParameter("value");}if("escPressed"in Z.getParameters()){b1=Z.getParameter("escPressed");}if("previousValue"in Z.getParameters()){a1=Z.getParameter("previousValue");}else{a1=this.getValue();}var c1=R.call(this);if(c1){c1.setFilterValue($);if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){c1.setSelectedKey("");}if(c1.openByTyping()){c1.open();}}this.fireLiveChange({value:$,escPressed:b1,previousValue:a1});}function P(Z){var $=this.getFieldInfo();if($&&!Z.getSource().getHref()){$.open();}this.firePress();}e.prototype.getFocusDomRef=function(){var Z=this._getContent();if(Z){return Z.getFocusDomRef();}else{return this.getDomRef();}};e.prototype.getIdForLabel=function(){var Z;var $=this._getContent();if($){Z=$.getIdForLabel();}else{Z=this.getId();}return Z;};e.mapEdmTypes={"Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Float":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.Single":"sap.ui.model.odata.type.Single","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};e.prototype._createDataType=function(Z){var $=q.sap.getObject(Z);if(!$){var a1=e.mapEdmTypes[Z];if(!a1){q.sap.log.error("Field","dataType for "+Z+" can not be created!");return null;}return this._createDataType(a1);}return new $(this.getDataTypeFormatOptions(),this.getDataTypeConstraints());};e.prototype._getDataType=function(Z){if(!this._oDataType){this._oDataType=this.getProperty("dataType");if(typeof this._oDataType==="string"){this._oDataType=this._createDataType(this._oDataType);}}return this._oDataType;};e.prototype.enhanceAccessibilityState=function(Z,$){var a1=this.getParent();if(a1&&a1.enhanceAccessibilityState){a1.enhanceAccessibilityState(this,$);}return $;};e.prototype.onsapup=function(Z){var $=R.call(this);if($){Z.preventDefault();Z.stopPropagation();$.navigate(-1);}};e.prototype.onsapdown=function(Z){var $=R.call(this);if($){Z.preventDefault();Z.stopPropagation();$.navigate(1);}};function Q(Z){var $=R.call(this);if($){$.setFilterValue("");$.toggleOpen();if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){$.setSelectedKey(this.getValue());}}}function R(){var Z=this.getFieldHelp();var $;if(Z){$=sap.ui.getCore().byId(Z);}return $;}function S(Z){var $=Z.getParameter("value");var a1=Z.getParameter("additionalValue");var b1=Z.getParameter("key");var c1;var d1;if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){c1=b1;d1=$;}else{c1=$;d1=a1;}this.setProperty("value",c1);this.setAdditionalValue(d1);this.fireChange({value:c1,valid:true});}function U(Z){var $=Z.getParameter("value");var a1=Z.getParameter("key");var b1;if(this.getDisplay()==sap.ui.mdc.FieldDisplay.Description){b1=a1;}else{b1=$;}var c1=this.getAggregation("_content");if(c1&&c1.setDOMValue){c1.setDOMValue($);c1._doSelect();}this.fireLiveChange({value:b1});}function V(Z){if(this.getEditMode()==E.Display){if(this.getAggregation("_content")){this.destroyAggregation("_content");}}else{_.call(this,this.getValue());}}function W(Z){if(this.getEditMode()==E.Display){var $=this.getFieldInfo();var a1=this.getAggregation("_content");if($&&a1){var b1=$.isTriggerable();if((b1&&!a1.setHref)||(!b1&&a1.setHref)){this.destroyAggregation("_content");f.call(this);}else if(b1){var c1=$.getTriggerHref();if(a1.setHref){a1.setHref(c1);}}}}}function X(Z){var $=R.call(this);$.detachEvent("select",S,this);$.detachEvent("navigate",U,this);$.detachEvent("disconnect",X,this);this._bConnected=false;}function Y(){var Z=R.call(this);if(Z&&!this._bConnected){Z.connect(this);this._bConnected=true;Z.attachEvent("select",S,this);Z.attachEvent("navigate",U,this);Z.attachEvent("disconnect",X,this);Z.setSelectedKey(this.getValue());}}return e;},true);
