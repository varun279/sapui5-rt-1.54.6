// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(['sap/ushell/resources','sap/ui/core/UIComponent','sap/ushell/components/flp/ComponentKeysHandler','sap/ushell/utils'],function(r,U,C,u){var s=sap.ushell.Container.getRenderer("fiori2").getShellController(),S=s.getView();return U.extend("sap.ushell.components.shell.ShellElements.Component",{metadata:{version:"1.53.0-SNAPSHOT",library:"sap.ushell.components.shell.ShellElements",dependencies:{libs:["sap.m"]}},createContent:function(){"use strict";var c=this.getComponentData().config;this.oDefConfig={};this.oDefConfig=jQuery.extend(this.oDefConfig,c);sap.ui.getCore().getEventBus().subscribe("shell","notificationsCompLoaded",this._handleNotificationsCompLoaded,this);sap.ui.getCore().getEventBus().subscribe("shell","userImageCompLoaded",this._handleUserImageCompLoaded,this);sap.ui.getCore().getEventBus().subscribe("shell","meAreaCompLoaded",this._handleNMeAreaCompLoaded,this);this._startComponentLoadSequence();},_startComponentLoadSequence:function(){if(this._notificationsEnabled()){sap.ui.getCore().getEventBus().publish("shell","loadNotificationsComponent");}else{this._handleNotificationsCompLoaded(undefined,undefined,{delay:0});}},_notificationsEnabled:function(){var a=window["sap-ushell-config"],l=false;if(a){if(a.services&&a.services.Notifications&&a.services.Notifications.config&&a.services.Notifications.config.enabled&&a.services.Notifications.config.enabled===true){l=true;}}return l;},_handleNotificationsCompLoaded:function(c,e,d){function g(){return S.getModel().getProperty('/currentState/stateName');}function i(){var v=S.getViewData()||{},o=v.config||{};return o.enableUserImage&&g()!=="headerless";}if(i()){if(!d||d.delay<=0){sap.ui.getCore().getEventBus().publish("shell","loadUserImageComponent");}else{setTimeout(function(){sap.ui.getCore().getEventBus().publish("shell","loadUserImageComponent");},d.delay);}}else{this._handleUserImageCompLoaded(undefined,undefined,{delay:0});}},_handleUserImageCompLoaded:function(c,e,d){var a=S.getModel().getProperty('/currentState/stateName'),l=true;if(a==="headerless"){l=false;}if(l){if(!d||d.delay<=0){sap.ui.getCore().getEventBus().publish("shell","loadMeAreaComponent");}else{setTimeout(function(){sap.ui.getCore().getEventBus().publish("shell","loadMeAreaComponent");},d.delay);}}else{this._handleNMeAreaCompLoaded(undefined,undefined,{delay:0});}},_handleNMeAreaCompLoaded:function(c,e,d){},exit:function(){"use strict";sap.ui.getCore().getEventBus().unsubscribe("shell","notificationsCompLoaded",this._handleNotificationsCompLoaded,this);sap.ui.getCore().getEventBus().unsubscribe("shell","userImageCompLoaded",this._handleUserImageCompLoaded,this);sap.ui.getCore().getEventBus().unsubscribe("shell","meAreaCompLoaded",this._handleNMeAreaCompLoaded,this);}});});
