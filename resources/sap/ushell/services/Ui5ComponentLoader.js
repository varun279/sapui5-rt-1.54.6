// Copyright (c) 2009-2017 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/Ui5ComponentHandle","sap/ushell/services/_Ui5ComponentLoader/utils"],function(U,u){"use strict";function a(c,p,C){this._oConfig=(C&&C.config)||{};this.createComponent=function(A,P,w){var o=A||{};var l=u.shouldLoadCoreExt(o);var b=u.shouldUseAmendedLoading(this._oConfig);var L=u.shouldLoadDefaultDependencies(o,this._oConfig,b);var d=o.applicationDependencies||{};u.logAnyApplicationDependenciesMessages(d.name,d.messages);if(!o.ui5ComponentName){return new jQuery.Deferred().resolve(A).promise();}delete o.loadCoreExt;delete o.loadDefaultDependencies;var e=this._createComponentData(o.componentData||{},o.url,o.applicationConfiguration,o.reservedParameters);var s=u.constructAppComponentId(P||{});var f=l&&b;var g=this._createComponentProperties(f,L,w,o.applicationDependencies||{},o.ui5ComponentName,o.url,s);U.onBeforeApplicationInstanceCreated.call(null,g);var D=new jQuery.Deferred();u.createUi5Component(g,e).then(function(h){var i=new U(h);o.componentHandle=i;var j=l&&(l||bCoreExtAlreadyLoaded||(b===false));if(j){o.coreResourcesFullyLoaded=j;}D.resolve(o);},function(E){var h=JSON.stringify(g,null,4);u.logInstantiateComponentError(g.name,E+"",E.status,E.stack,h);D.reject(E);});return D.promise();};this._createComponentData=function(b,s,A,t){var o=jQuery.extend(true,{startupParameters:{}},b);if(A){o.config=A;}if(t){o.technicalParameters=t;}if(u.urlHasParameters(s)){var d=u.getParameterMap(s);o.startupParameters=d.startupParameters;if(d["sap-xapp-state"]){o["sap-xapp-state"]=d["sap-xapp-state"];}}return o;};this._createComponentProperties=function(A,l,w,o,s,b,d){var e=jQuery.extend(true,{},o);if(!e.asyncHints){e.asyncHints=l?{"libs":["sap.ca.scfld.md","sap.ca.ui","sap.me","sap.ui.unified"]}:{};}if(A){e.asyncHints.preloadBundles=e.asyncHints.preloadBundles||[];if(window["sap-ui-debug"]){e.asyncHints.preloadBundles.push("sap/fiori/core-ext-light-dbg.js");}else{e.asyncHints.preloadBundles.push("sap/fiori/core-ext-light-0.js");e.asyncHints.preloadBundles.push("sap/fiori/core-ext-light-1.js");e.asyncHints.preloadBundles.push("sap/fiori/core-ext-light-2.js");e.asyncHints.preloadBundles.push("sap/fiori/core-ext-light-3.js");}}if(w){e.asyncHints.waitFor=w;}if(!e.name){e.name=s;}if(b){e.url=u.removeParametersFromUrl(b);}if(d){e.id=d;}return e;};}a.hasNoAdapter=true;return a;},true);
