sinaDefine(['../../core/core','../../core/util','./typeConverter','../../sina/fiori/FioriIntentsResolver','../../sina/NavigationTarget'],function(c,u,t,I,N){return c.defineClass({_init:function(p){this.provider=p;this.sina=p.sina;this.intentsResolver=this.sina._createFioriIntentsResolver();},parse:function(s,d){if(d.value===null){return Promise.resolve([]);}var a=d.value;var b=[];for(var i=0;i<a.length;++i){var e=a[i];var f=this.parseItem(e);b.push(f);}return Promise.all(b);},parseItem:function(a){var b=[];var d=[];var w=[];var s={};var e=a['@odata.context'];var p=e.lastIndexOf('#');if(p>-1){e=e.slice(p+1);}var f=this.sina.getDataSource(e);var g=a['@com.sap.vocabularies.Search.v1.WhyFound']||{};var m={};var h='';for(var j in a){if(j[0]==='@'||j[0]==='_'){continue;}m=f.getAttributeMetadata(j);var k=t.odata2Sina(m.type,a[j]);var l="";for(var n in g){if(n===j&&g[n][0]){l=g[n][0];delete g[n];}}var o=this.sina._createSearchResultSetItemAttribute({id:m.id,label:m.label,value:k,valueFormatted:k,valueHighlighted:l||k,isHighlighted:l.length>0?true:false,metadata:m});o=u.addPotentialNavTargetsToAttribute(this.sina,o);if(m.usage.Title){b.push(o);}if(m.usage.Detail){d.push(o);}h=f.attributeMetadataMap[m.id].semanticObjectType||'';if(h.length>0){s[h]=k;}}b.sort(function(A,B){return A.metadata.usage.Title.displayOrder-B.metadata.usage.Title.displayOrder;});d.sort(function(A,B){return A.metadata.usage.Detail.displayOrder-B.metadata.usage.Detail.displayOrder;});var q=[];var r=[];for(var i=0;i<b.length;++i){var v=b[i];q.push(v.valueFormatted);r.push(v.valueHighlighted);}q=q.join(' ');r=r.join(' ');h=f.sematicObjectType||'';var x=f.system||'';var y=f.client||'';var z;return this.intentsResolver.resolveIntents({semanticObjectType:h,semanticObjectTypeAttributes:s,systemId:x,client:y,fallbackDefaultNavigationTarget:z}).then(function(A){var B=A&&A.defaultNavigationTarget;var C=A&&A.navigationTargets;return this.sina._createSearchResultSetItem({dataSource:f,title:q,titleHighlighted:r,titleAttributes:b,detailAttributes:d,defaultNavigationTarget:B,navigationTargets:C});}.bind(this));}});});
