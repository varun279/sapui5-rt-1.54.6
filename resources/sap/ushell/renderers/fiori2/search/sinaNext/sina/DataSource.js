sinaDefine(['../core/core','./SinaObject'],function(c,S){return S.derive({_meta:{properties:{type:{required:true},id:{required:true},label:{required:true},multiId:{required:false},labelPlural:{required:false},hidden:{required:false,default:false},attributesMetadata:{required:false,default:function(){return[];}},attributeMetadataMap:{required:false,default:function(){return{};}}}},equals:function(){throw new c.Exception('use === operator for comparison of datasources');},_afterInitProperties:function(){if(!this.multiId||this.multiId.length===0){this.multiId=this.sina.provider.id+"_"+this.id;}if(!this.labelPlural||this.labelPlural.length===0){this.labelPlural=this.label;}if(this.type===this.sina.DataSourceType.BusinessObject&&this.attributesMetadata.length===0){throw'attributes of datasource are missing';}this.attributeMetadataMap=this.createAttributeMetadataMap(this.attributesMetadata);},createAttributeMetadataMap:function(a){var m={};for(var i=0;i<a.length;++i){var b=a[i];m[b.id]=b;}return m;},getAttributeMetadata:function(i){return this.attributeMetadataMap[i];},toJson:function(){return{type:this.type,id:this.sina.provider.parentSina?this.multiId:this.id,label:this.label,labelPlural:this.labelPlural};}});});
