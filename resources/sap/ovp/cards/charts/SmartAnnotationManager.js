(function(){"use strict";jQuery.sap.declare("sap.ovp.cards.charts.SmartAnnotationManager");jQuery.sap.require("sap.ovp.cards.charts.Utils");sap.ovp.cards.charts.SmartAnnotationManager=sap.ovp.cards.charts.SmartAnnotationManager||{};sap.ovp.cards.charts.SmartAnnotationManager.constants={LABEL_KEY:"sap:label",LABEL_KEY_V4:"com.sap.vocabularies.Common.v1.Label",TEXT_KEY:"sap:text",TEXT_KEY_V4:"com.sap.vocabularies.Common.v1.Text",TYPE_KEY:"type",DISPLAY_FORMAT_KEY:"sap:display-format",SEMANTICS_KEY:"sap:semantics",UNIT_KEY:"sap:unit",UNIT_KEY_V4_ISOCurrency:"Org.OData.Measures.V1.ISOCurrency",UNIT_KEY_V4_Unit:"Org.OData.Measures.V1.Unit",CURRENCY_CODE:"currency-code",NAME_KEY:"name",NAME_CAP_KEY:"Name",EDM_TYPE:"type",EDM_INT32:"Edm.Int32",SCATTER_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Scatter",BUBBLE_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Bubble",LINE_CHARTTYPE:"com.sap.vocabularies.UI.v1.ChartType/Line"};sap.ovp.cards.charts.SmartAnnotationManager.errorMessages={CARD_WARNING:"OVP-AC: Analytic card: Warning: ",CARD_ERROR:"OVP-AC: Analytic card Error: ",DATA_ANNO_ERROR:"OVP-AC: Analytic card Error:",CARD_ANNO_ERROR:"OVP-AC: Analytic card: Error ",CHART_ANNO_ERROR:"OVP-AC: Analytic card: Error ",INVALID_CHART_ANNO:"OVP-AC: Analytic Cards: Invalid Chart Annotation.",ANALYTICAL_CONFIG_ERROR:"Analytic card configuration error",CACHING_ERROR:"no model defined while caching OdataMetaData",INVALID_MAXITEMS:"maxItems is Invalid. ",NO_DATASET:"OVP-AC: Analytic Cards: Could not obtain dataset.",SORTORDER_WARNING:"SortOrder is present in PresentationVariant, but it is empty or not well formed.",BOOLEAN_ERROR:"Boolean value is not present in PresentationVariant.",IS_MANDATORY:"is mandatory.",IS_MISSING:"is missing.",NOT_WELL_FORMED:"is not found or not well formed)",MISSING_CHARTTYPE:"Missing ChartType in ",CHART_ANNO:"Chart Annotation.",DATA_ANNO:"Data Annotation",CARD_ANNO:"card annotation.",CARD_CONFIG:"card configuration.",CARD_CONFIG_ERROR:"Could not obtain configuration for ",CARD_CONTAINER_ERROR:"Could not obtain card container. ",DATA_UNAVAIALABLE:"No data available.",CONFIG_LOAD_ERROR:"Failed to load config.json. Reason: ",INVALID_CHARTTYPE:"Invalid ChartType given for ",INVALID_CONFIG:"No valid configuration given for ",CONFIG_JSON:"in config.json",ENTER_INTEGER:"Please enter an Integer.",NO_CARD_MODEL:"Could not obtain Cards model.",ANNO_REF:"com.sap.vocabularies.UI.v1 annotation.",INVALID_REDUNDANT:"Invalid/redundant role configured for ",CHART_IS:"chart is/are ",CARD_CONFIG_JSON:"card from config.json",ALLOWED_ROLES:"Allowed role(s) for ",DIMENSIONS_MANDATORY:"DimensionAttributes are mandatory.",MEASURES_MANDATORY:"MeasureAttributes are mandatory.",CARD_LEAST:"card: Enter at least ",CARD_MOST:"card: Enter at most ",FEEDS:"feed(s).",MIN_FEEDS:"Minimum number of feeds required for ",FEEDS_OBTAINED:"card is not configured. Obtained ",FEEDS_REQUIRED:"feed(s), Required: ",INVALID_SEMANTIC_MEASURES:"More than one measure is being semantically coloured",INVALID_IMPROVEMENT_DIR:"No Improvement Direction Found",INVALID_CRITICALITY:"Invalid criticality values",INVALID_DIMMEAS:"Invalid number of Measures or Dimensions",INVALID_FORECAST:"Invalid/Redundant Datapoint or Forecast measure",ERROR_MISSING_AXISSCALES:"Minimum and Maximum values are mandatory for AxisScale MinMax to work"};sap.ovp.cards.charts.SmartAnnotationManager.formatItems=function(c,e,s,p,D,M,a){var b=c.getSetting("dataModel");var f;if(a&&a.EnumMember){f=a.EnumMember.split("/");if(f&&(f[1]!='Donut')&&(D===undefined)){return null;}if(f){b.setDefaultCountMode(sap.ui.model.odata.CountMode.Inline);}}var r="{";var g=[];var h=[];var j=[];var F=s&&s.SelectOptions;var P=s&&s.Parameters;var S=p&&p.SortOrder;var k=p&&p.MaxItems,l=null;var C;var t;var n=null;var o=sap.ovp.cards.charts.SmartAnnotationManager;var q=o.constants.TEXT_KEY;var u=o.constants.TEXT_KEY_V4;var v=o.constants.UNIT_KEY;var w=o.constants.UNIT_KEY_V4_ISOCurrency;var x=o.constants.UNIT_KEY_V4_Unit;if(k){l=k.Int32?k.Int32:k.Int;}if(l){if(l=="0"){jQuery.sap.log.error("OVP-AC: Analytic card Error: maxItems is configured as "+l);r+="}";return r;}if(!/^\d+$/.test(l)){jQuery.sap.log.error("OVP-AC: Analytic card Error: maxItems is Invalid. "+"Please enter an Integer.");r+="}";return r;}}var y,z,A,B=o.getConfig(),E=c.getSetting('ovpCardProperties');if(D){for(var G in B){if((y=B[G].reference)&&B[y]){var H=jQuery.extend(true,{},B[y]);B[G]=H;}if(B[G].default.type==f[1].toLowerCase()||(B[G].time&&B[G].time.type==f[1].toLowerCase())){z=B[G];break;}}var I=sap.ovp.cards.charts.VizAnnotationManager.hasTimeSemantics(D,z,b,n);if(I){z=z.time;}else{z=z.default;}A=E.getProperty('/dataStep');if(!A){if(z.resize&&z.resize.hasOwnProperty('dataStep')){A=z.resize.dataStep;E.setProperty('/dataStep',A);}}}if(E.getProperty('/layoutDetail')==='resizable'){var J=E.getProperty('/cardLayout/colSpan');l=+l+ +A*(J-1);}var K=E.getProperty('/parameters');P=P||!!K;if(P){var L=sap.ovp.cards.AnnotationHelper.resolveParameterizedEntitySet(b,e,s,K);r+="path: '"+L+"'";}else{r+="path: '/"+e.name+"'";}var N=[];if(!c||!c.getSetting('ovpCardProperties')){jQuery.sap.log.error(o.errorMessages.ANALYTICAL_CONFIG_ERROR);r+="}";return r;}n=c.getSetting('ovpCardProperties').getProperty("/entitySet");if(!b||!n){return r;}var O=o.getMetadata(b,n);C=c.getSetting('ovpCardProperties').getProperty("/filters");if(F){jQuery.each(s.SelectOptions,function(){var d=this.PropertyName.PropertyPath;jQuery.each(this.Ranges,function(){if(this.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"){var m=sap.ovp.cards.charts.SmartAnnotationManager.getPrimitiveValue(this.Low);var Z=this.High&&this.High.String;var $=o.formatByType;m=$(O,d,m);var _={path:d,operator:this.Option.EnumMember.split("/")[1],value1:m};if(Z){_.value2=$(O,d,Z);}N.push(_);}});});}if(C&&C.length>0){N=N.concat(C);}if(N.length>0){r+=", filters: "+JSON.stringify(N);}if(S){var Q=p.SortOrder;if(!Q.length){Q=sap.ovp.cards.charts.Utils.getSortAnnotationCollection(b,p,e);}if(Q.length<1){jQuery.sap.log.warning(o.errorMessages.CARD_WARNING+o.errorMessages.SORTORDER_WARNING);}else{var R="";var T;var U;var V;for(var i=0;i<Q.length;i++){T=Q[i];V=T.Property.PropertyPath;j.push(V);if(typeof T.Descending=="undefined"){U='true';}else{var W=T.Descending.Bool||T.Descending.Boolean;if(!W){jQuery.sap.log.warning(o.errorMessages.CARD_WARNING+o.errorMessages.BOOLEAN_ERROR);U='true';}else{U=W.toLowerCase()=='true'?'true':'false';}}R=R+"{path: '"+V+"',descending: "+U+"},";}r+=", sorter: ["+R.substring(0,R.length-1)+"]";}}var X=c.getSetting("ovpCardProperties").getProperty("/entityType");jQuery.each(M,function(i,m){t=m.Measure.PropertyPath;if(m.DataPoint&&m.DataPoint.AnnotationPath){var d=X[m.DataPoint.AnnotationPath.substring(1)];if(d&&d.ForecastValue&&d.ForecastValue.PropertyPath){h.push(d.ForecastValue.PropertyPath);}if(d&&d.TargetValue&&d.TargetValue.PropertyPath){h.push(d.TargetValue.PropertyPath);}}h.push(t);if(O&&O[t]){if(O[t][u]){if(O[t][u].String&&t!=O[t][u].String){h.push(O[t][u].String?O[t][u].String:t);}else if(O[t][u].Path&&t!=O[t][u].Path){h.push(O[t][u].Path?O[t][u].Path:t);}}else if(O[t][q]&&t!=O[t][q]){h.push(O[t][q]?O[t][q]:t);}}if(O&&O[t]){var Z;if(O[t][w]){Z=O[t][w].Path?O[t][w].Path:O[t][w].String;}else if(O[t][x]){Z=O[t][x].Path?O[t][x].Path:O[t][x].String;}else if(O[t][v]){Z=O[t][v];}if(Z){if(jQuery.inArray(Z,h)===-1){h.push(Z);}}}});jQuery.each(D,function(i,d){t=d.Dimension.PropertyPath;g.push(t);if(O&&O[t]){if(O[t][u]){if(O[t][u].String&&t!=O[t][u].String){g.push(O[t][u].String?O[t][u].String:t);}else if(O[t][u].Path&&t!=O[t][u].Path){g.push(O[t][u].Path?O[t][u].Path:t);}}else if(O[t][q]&&t!=O[t][q]){g.push(O[t][q]?O[t][q]:t);}}});r+=", parameters: {select:'"+[].concat(g,h).join(",");if(j.length>0){r+=","+j.join(",");}r+="'";var Y=[];jQuery.each(g,function(i,d){var m=d.indexOf("/");if(m>0){var Z=d.split("/");Z.splice(-1,1);Z=Z.join("/");Y.push(Z);}});if(Y.length>0){r+=", expand:'"+Y.join(",")+"'";}r+="}";if(f&&(f[1]==='Donut')&&(D===undefined)){r+=", length: 1";}else if(f&&(f[1]==='Donut')&&(D)&&l){r+=", length: "+(parseInt(l,10)+1);}else if(l){r+=", length: "+l;}r+="}";return r;};sap.ovp.cards.charts.SmartAnnotationManager.formatItems.requiresIContext=true;sap.ovp.cards.charts.SmartAnnotationManager.formatChartAxes=function(){jQuery.sap.require("sap.ui.core.format.NumberFormat");var c={locale:function(){},format:function(v,p){var a="";if(p){a=p.split('/');}if(a.length>0){var m,s;if(a.length==3){m=Number(a[1]);s=Number(a[2]);if(isNaN(m)){m=-1;}if(isNaN(s)){s=0;}}else{m=2;s=0;}if(a[0]=="axisFormatter"||(a[0]=="ShortFloat")){var n;n=sap.ui.core.format.NumberFormat.getFloatInstance({style:'short',minFractionDigits:m,maxFractionDigits:m});if(a[0]=="ShortFloat"){n=sap.ui.core.format.NumberFormat.getFloatInstance({style:'short',minFractionDigits:m,maxFractionDigits:m});}if(m===-1){n=sap.ui.core.format.NumberFormat.getFloatInstance({style:'short'});}return n.format(Number(v));}else if(a[0]==="tooltipNoScaleFormatter"){var t=sap.ui.core.format.NumberFormat.getFloatInstance({style:'short',currencyCode:false,shortRefNumber:s,showScale:false,minFractionDigits:m,maxFractionDigits:m});if(m===-1){t=sap.ui.core.format.NumberFormat.getCurrencyInstance({style:'short',currencyCode:false});}return t.format(Number(v));}else if(a[0]=="CURR"){var b=sap.ui.core.format.NumberFormat.getCurrencyInstance({style:'short',currencyCode:false,minFractionDigits:m,maxFractionDigits:m});if(m===-1){b=sap.ui.core.format.NumberFormat.getCurrencyInstance({style:'short',currencyCode:false});}return b.format(Number(v));}else if(a[0].search("%")!==-1){var d=sap.ui.core.format.NumberFormat.getPercentInstance({style:'short',minFractionDigits:m,maxFractionDigits:m});if(m===-1){d=sap.ui.core.format.NumberFormat.getPercentInstance({style:'short',minFractionDigits:1,maxFractionDigits:1});}v=d.format(Number(v));return v;}}if(v.constructor===Date){jQuery.sap.require("sap.ui.core.format.DateFormat");var D=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:p});if(p==="YearMonthDay"){D=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});}v=D.format(new Date(v));}return v;}};jQuery.sap.require("sap.viz.ui5.api.env.Format");sap.viz.ui5.api.env.Format.numericFormatter(c);};sap.ovp.cards.charts.SmartAnnotationManager.checkExists=function(t,a,b,m,l,c){var s=sap.ovp.cards.charts.SmartAnnotationManager;m=typeof m==="undefined"?false:m;var r=false;var d;if(!t&&m){jQuery.sap.log.error(l+s.errorMessages.CARD_ERROR+b+s.errorMessages.IS_MANDATORY);return r;}if(!t){jQuery.sap.log.warning(l+s.errorMessagesCARD_WARNING+b+s.errorMessages.IS_MISSING);r=true;return r;}d=a[t];if(!d||typeof d!=="object"){var e=m?jQuery.sap.log.error:jQuery.sap.log.warning;e(l+s.errorMessages.CARD_ERROR+"in "+b+". ("+t+" "+s.errorMessages.NOT_WELL_FORMED);return r;}if(c&&c=="sap.ovp.cards.charts.analytical.analyticalChart"&&b=="Chart Annotation"&&(!d.ChartType||!d.ChartType.EnumMember)){jQuery.sap.log.error(l+s.errorMessages.CARD_ERROR+s.errorMessages.MISSING_CHARTTYPE+s.errorMessages.CHART_ANNO);return r;}r=true;return r;};sap.ovp.cards.charts.SmartAnnotationManager.validateCardConfiguration=function(c){var s=sap.ovp.cards.charts.SmartAnnotationManager;var r=false;if(!c){return r;}var a;var b;var d;var p;var i;var P;var e;var l="";var C;var v=c.getView();if(v){l="["+v.getId()+"] ";}if(!(C=c.getCardPropertiesModel())){jQuery.sap.log.error(l+s.errorMessages.CARD_ERROR+"in "+s.errorMessages.CARD_CONFIG+s.errorMessages.NO_CARD_MODEL);return r;}e=C.getProperty("/entityType");if(!e||jQuery.isEmptyObject(e)){jQuery.sap.log.error(l+s.errorMessages.CARD_ERROR+"in "+s.errorMessages.CARD_ANNO);return r;}a=C.getProperty("/selectionAnnotationPath");b=C.getProperty("/chartAnnotationPath");p=C.getProperty("/presentationAnnotationPath");i=C.getProperty("/identificationAnnotationPath");P=C.getProperty("/dataPointAnnotationPath");d=C.getProperty("/contentFragment");r=this.checkExists(a,e,"Selection Variant",false,l);r=this.checkExists(b,e,"Chart Annotation",true,l,d)&&r;r=this.checkExists(p,e,"Presentation Variant",false,l)&&r;r=this.checkExists(i,e,"Identification Annotation",true,l)&&r;r=this.checkExists(P,e,"Data Point",false,l)&&r;return r;};sap.ovp.cards.charts.SmartAnnotationManager.getConfig=function(c){var s=sap.ovp.cards.charts.SmartAnnotationManager;var r={};var a,b,d,f,g=null;var C=!!c;if(!jQuery.sap.getObject("sap.ovp.cards.charts.config")){d=jQuery.sap.getModulePath("sap.ovp.cards.charts");sap.ovp.cards=sap.ovp.cards||{};sap.ovp.cards.charts=sap.ovp.cards.charts||{};try{sap.ovp.cards.charts.config=jQuery.sap.loadResource({url:d+"/config.json",dataType:"json",async:false});}catch(e){jQuery.sap.log.error(s.errorMessages.CONFIG_LOAD_ERROR+e);}sap.ovp.cards.charts.config=sap.ovp.cards.charts.config||{};}g=sap.ovp.cards.charts.config;if(!C){return g;}if(!c.EnumMember||!(a=c.EnumMember.split("/"))||a.length<2){jQuery.sap.log.error(s.errorMessages.CARD_ERROR+s.errorMessages.INVALID_CHARTTYPE+s.errorMessages.ANNO_REF);return r;}b=a[1];if(!g[b]){jQuery.sap.log.error(s.errorMessages.INVALID_CONFIG+b+" "+s.errorMessages.CONFIG_JSON);return r;}if((f=g[b].reference)&&g[f]){var v=jQuery.extend(true,{},g[f]);g[b]=v;}r=g[b];return r;};sap.ovp.cards.charts.SmartAnnotationManager.hasTimeSemantics=function(d,c,a,e){var r=false;var m;var b;var f;var g;var s;var h;if(!c.time||jQuery.isEmptyObject(c.time)){return r;}if(!d){return r;}if(!d[0].Dimension||!(b=d[0].Dimension.PropertyPath)){return r;}m=this.getMetadata(a,e);for(var i=0;i<d.length;i++){if(d[i]&&d[i].Dimension&&d[i].Dimension.PropertyPath){b=d[i].Dimension.PropertyPath;}if(m&&m[b]){f=m[b][this.constants.TYPE_KEY];g=m[b][this.constants.DISPLAY_FORMAT_KEY];s=m[b][this.constants.SEMANTICS_KEY];h=m[b]["com.sap.vocabularies.Common.v1.IsCalendarYear"];}if(f&&g&&f.lastIndexOf("Edm.Date",0)===0&&g.toLowerCase()=="date"){r=true;return r;}if(f=="Edm.String"&&(h||s&&s.lastIndexOf("year",0)===0)){r=true;return r;}}return r;};sap.ovp.cards.charts.SmartAnnotationManager.getChartType=function(c,C,d){var r="";var s=sap.ovp.cards.charts.SmartAnnotationManager;var a=s.getConfig(C);var b,e;if(!a){return r;}r=a.default.type;b=c.getSetting("dataModel");e=c.getSetting('ovpCardProperties').getProperty("/entitySet");if(s.hasTimeSemantics(d,a,b,e)){r=a.time.type;}return r;};sap.ovp.cards.charts.SmartAnnotationManager.getChartType.requiresIContext=true;sap.ovp.cards.charts.SmartAnnotationManager.checkRolesForProperty=function(q,c,t){var s=sap.ovp.cards.charts.SmartAnnotationManager;if(!q.length){return;}var a=t=="dimension"?"Dimension":"Measure";var b=[];jQuery.each(q,function(i,v){if(!v||!v[a]||!v[a].PropertyPath){jQuery.sap.log.error(s.errorMessages.INVALID_CHART_ANNO);return false;}b.push(v[a].PropertyPath);});var d=jQuery.map(c.feeds,function(f){if(f.type==t){if(f.role){return f.role.split("|");}return[];}});d=jQuery.grep(d,function(r,i){return jQuery.inArray(r,d)==i;}).join(", ");jQuery.sap.log.error(s.errorMessages.CARD_ERROR+s.errorMessages.INVALID_REDUNDANT+t+"(s) "+b.join(", ")+". "+s.errorMessages.ALLOWED_ROLES+c.type+s.errorMessages.CHART_IS+d);};sap.ovp.cards.charts.SmartAnnotationManager.getPrimitiveValue=function(v){var a;if(v){if(v.String){a=v.String;}else if(v.Boolean||v.Bool){a=sap.ovp.cards.charts.SmartAnnotationManager.getBooleanValue(v);}else{a=sap.ovp.cards.charts.SmartAnnotationManager.getNumberValue(v);}}return a;};sap.ovp.cards.charts.SmartAnnotationManager.getBooleanValue=function(v,d){if(v&&v.Boolean){if(v.Boolean.toLowerCase()==="true"){return true;}else if(v.Boolean.toLowerCase()==="false"){return false;}}else if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return d;};sap.ovp.cards.charts.SmartAnnotationManager.getNumberValue=function(v){var a;if(v){if(v.String){a=Number(v.String);}else if(v.Int){a=Number(v.Int);}else if(v.Decimal){a=Number(v.Decimal);}else if(v.Double){a=Number(v.Double);}else if(v.Single){a=Number(v.Single);}}return a;};sap.ovp.cards.charts.SmartAnnotationManager.checkNumberFormat=function(m,v,e){if(v&&v.DataPoint&&v.DataPoint.AnnotationPath){var d=e[v.DataPoint.AnnotationPath.substring(1)];var f,a;if(d&&d.ValueFormat){f=d.ValueFormat;}else if(d&&d.NumberFormat){f=d.NumberFormat;}if(f&&f.NumberOfFractionalDigits&&f.NumberOfFractionalDigits.Int){a=f.NumberOfFractionalDigits.Int;if(m<Number(a)){m=Number(a);}}}return m;};sap.ovp.cards.charts.SmartAnnotationManager.getMaxScaleFactor=function(m,v,e){if(v&&v.DataPoint&&v.DataPoint.AnnotationPath){var d=e[v.DataPoint.AnnotationPath.substring(1)];var s,S;if(d&&d.ValueFormat){s=d.ValueFormat;}else if(d&&d.NumberFormat){s=d.NumberFormat;}if(s){if(s.ScaleFactor&&s.ScaleFactor.Decimal){S=Number(s.ScaleFactor.Decimal);}else if(s.ScaleFactor&&s.ScaleFactor.Int){S=Number(s.ScaleFactor.Int);}if(!isNaN(S)){if(m===undefined){m=Number(S);}else if(m>Number(S)){m=Number(S);}}}}return m;};sap.ovp.cards.charts.SmartAnnotationManager.isMeasureCurrency=function(m,s){var a=sap.ovp.cards.charts.SmartAnnotationManager;if(m&&m[s]&&(m[s]["Org.OData.Measures.V1.ISOCurrency"]||(m[s][a.constants.SEMANTICS_KEY]&&m[s][a.constants.SEMANTICS_KEY]===a.constants.CURRENCY_CODE))){return true;}return false;};sap.ovp.cards.charts.SmartAnnotationManager.fractionalDigitsExists=function(v,e){if(v.DataPoint&&v.DataPoint.AnnotationPath){var d=e[v.DataPoint.AnnotationPath.substring(1)];if(d&&d.ValueFormat&&d.ValueFormat.NumberOfFractionalDigits&&d.ValueFormat.NumberOfFractionalDigits.Int){return true;}else if(d&&d.NumberFormat&&d.NumberFormat.NumberOfFractionalDigits&&d.NumberFormat.NumberOfFractionalDigits.Int){return true;}}return false;};sap.ovp.cards.charts.SmartAnnotationManager.checkEDMINT32Exists=function(m,v,f){var s=sap.ovp.cards.charts.SmartAnnotationManager;if(m[v[f].PropertyPath][s.constants.EDM_TYPE]==s.constants.EDM_INT32){return true;}return false;};sap.ovp.cards.charts.SmartAnnotationManager.setChartScaleTitle=function(v,a,h,c){var C,e,b,d;var M;var s=sap.ovp.cards.charts.SmartAnnotationManager;var u=s.constants.UNIT_KEY;var f=s.constants.UNIT_KEY_V4_ISOCurrency;var g=s.constants.UNIT_KEY_V4_Unit;if(!(C=v.getModel('ovpCardProperties'))){jQuery.sap.log.error(s.errorMessages.CARD_ERROR+"in "+s.errorMessages.CARD_CONFIG+s.errorMessages.NO_CARD_MODEL);return;}var j=v.getModel();var k=C.getProperty("/entitySet");if(!j||!k){return;}e=C.getProperty("/entityType");if(!e){jQuery.sap.log.error(s.errorMessages.CARD_ANNO_ERROR+"in "+s.errorMessages.CARD_ANNO);return;}var o=s.getMetadata(j,k);b=C.getProperty("/chartAnnotationPath");if(!b||!(d=e[b])){jQuery.sap.log.error(s.errorMessages.CARD_ANNO_ERROR+"in "+s.errorMessages.CARD_ANNO);return;}if(!(M=d.MeasureAttributes)||!M.length){jQuery.sap.log.error(s.errorMessages.CHART_ANNO_ERROR+"in "+s.errorMessages.CHART_ANNO+" "+s.errorMessages.MEASURES_MANDATORY);return;}var r=a?a.results:null;var p,l="",n=[];var q=true;var t=[];var w=v.getFeeds();jQuery.each(w,function(i,m){if(m.getType()==="Measure"){t=t.concat(m.getValues());}});var x="";if(r){jQuery.each(M,function(i,m){var z="";p=m.Measure.PropertyPath;if(o&&o[p]){if(o[p][s.constants.LABEL_KEY_V4]){z=o[p][s.constants.LABEL_KEY_V4].String?o[p][s.constants.LABEL_KEY_V4].String:o[p][s.constants.LABEL_KEY_V4].Path;}else if(o[p][s.constants.LABEL_KEY]){z=o[p][s.constants.LABEL_KEY];}else if(p){z=p;}}if(jQuery.inArray(z,t)!=-1){if(o&&o[p]){var A;if(o[p][f]){A=o[p][f].Path?o[p][f].Path:o[p][f].String;}else if(o[p][g]){A=o[p][g].Path?o[p][g].Path:o[p][g].String;}else if(o[p][u]){A=o[p][u];}if(A&&o[A]){for(var i=0;i<r.length;i++){var B=r[i];if(q){if(l&&B[A]&&(B[A]!="")&&(l!="")&&(l!=B[A])){q=false;}}l=B[A];if(l&&l!=""){var D={};D.name=z;D.value=l;n.push(D);break;}}}}}});}var V=v.getVizProperties();var y="";if(h){x=h.getScale();}if(q){if(isNaN(Number(x))&&x!=undefined){if(l!=""){y=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN",[x,l]);}else{y=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN_NO_SCALE",[x]);}}else if(l!=""){y=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN_NO_SCALE",[l]);}if(c){c.setText(y);c.data("aria-label",y,true);}}else if(!q){jQuery.each(V,function(i,m){if(m&&m.title){var z=m.title.text;for(var i=0;i<n.length;i++){if(n[i].name===z){var A="";if(isNaN(Number(x))&&x!=undefined){if(l!=""){A=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE",[z,x,n[i].value]);}else{A=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE_NO_SCALE",[x]);}}else if(l!=""){A=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE_NO_SCALE",[z,n[i].value]);}m.title={text:A};}}}});v.setVizProperties(V);}};sap.ovp.cards.charts.SmartAnnotationManager.getMetadata=function(m,e){var a=this.cacheODataMetadata(m);if(!a){return undefined;}return a[e];};sap.ovp.cards.charts.SmartAnnotationManager.setSmartFormattedChartTitle=function(m,d,s){var t="",a="",b="";if(s){t=s.getHeader();}if(m&&(m.length>1)){for(var i=0;i<m.length-1;i++){if(a!=""){a+=", ";}a+=m[i];}a=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("MEAS_DIM_TITLE",[a,m[i]]);}else if(m){a=m[0];}if(d&&(d.length>1)){for(var i=0;i<d.length-1;i++){if(b!=""){b+=", ";}b+=d[i];}b=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("MEAS_DIM_TITLE",[b,d[i]]);}else if(d){b=d[0];}if(s&&s.getHeader()=="Dummy"){t=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("NO_CHART_TITLE",[a,b]);s.setHeader(t);}return t;};sap.ovp.cards.charts.SmartAnnotationManager.getScaleUnit=function(m,i){var n=1;var s;if(i){var c=sap.ui.core.format.NumberFormat.getCurrencyInstance({style:'short',currencyCode:false,shortRefNumber:m});s=c.format(Number(n));}else{var a=sap.ui.core.format.NumberFormat.getFloatInstance({style:'short',shortRefNumber:m});s=a.format(Number(n));}var b=s.slice(-1);return b;};sap.ovp.cards.charts.SmartAnnotationManager.cacheODataMetadata=function(m){var s=sap.ovp.cards.charts.SmartAnnotationManager;if(m){if(!jQuery.sap.getObject("sap.ovp.cards.charts.cachedMetaModel")){sap.ovp.cards.charts.cachedMetaModel={};}var a=sap.ovp.cards.charts.cachedMetaModel[m.getId()];if(!a){var b=m.getMetaModel();a={};var c=b.getODataEntityContainer();jQuery.each(c.entitySet,function(d,e){var f=b.getODataEntityType(e.entityType);var g={};jQuery.each(f.property,function(p,h){g[h.name]=h;});a[e.name]=g;});sap.ovp.cards.charts.cachedMetaModel[m.getId()]=a;}return a;}else{jQuery.sap.log.error(s.errorMessages.CARD_ERROR+s.errorMessages.CACHING_ERROR);}};sap.ovp.cards.charts.SmartAnnotationManager.getSelectedDataPoint=function(v,c){v.attachSelectData(function(e){var s=sap.ovp.cards.charts.SmartAnnotationManager;var C=v.getModel('ovpCardProperties');var d=v.getModel();var a=C.getProperty("/entitySet");var m=s.getMetadata(d,a);var b=[],f=[];var g={};var h=v.getDataset().getDimensions();var l;for(var i=0;i<h.length;i++){b.push(h[i].getName());}var n=jQuery.map(v.getDataset()._getDataContexts(),function(x){return x.getObject();});if(e.getParameter("data")&&e.getParameter("data")[0]&&e.getParameter("data")[0].data){l=e.getParameter("data")[0].data._context_row_number;if(n[l].$isOthers&&n[l].$isOthers==true){var o={$isOthers:true};var p={getObject:function(){return o;}};c.doNavigation(p);}else{f=Object.keys(e.getParameter("data")[0].data);for(var j=0;j<b.length;j++){for(var k=0;k<f.length;k++){if(b[j]==f[k]){for(var q in m){if(m.hasOwnProperty(q)){var r=m[q][s.constants.LABEL_KEY]||m[q][s.constants.NAME_KEY]||m[q][s.constants.NAME_CAP_KEY];if(r==f[k]){g[q]=n[l][q];}}}}}}var p={getObject:function(){return g;}};c.doNavigation(p);}}});};sap.ovp.cards.charts.SmartAnnotationManager.checkBubbleChart=function(c){if(c.EnumMember.endsWith("Bubble")){return true;}else{return false;}};sap.ovp.cards.charts.SmartAnnotationManager.dimensionAttrCheck=function(d){var r=false;var s=sap.ovp.cards.charts.SmartAnnotationManager;if(!d||d.constructor!=Array||d.length<1||d[0].constructor!=Object||!d[0].Dimension||!d[0].Dimension.PropertyPath){jQuery.sap.log.error(s.errorMessages.CHART_ANNO_ERROR+"in "+s.errorMessages.CHART_ANNO+" "+s.errorMessages.DIMENSIONS_MANDATORY);return r;}r=true;return r;};sap.ovp.cards.charts.SmartAnnotationManager.measureAttrCheck=function(m){var r=false;var s=sap.ovp.cards.charts.SmartAnnotationManager;if(!m||m.constructor!=Array||m.length<1||m[0].constructor!=Object||!m[0].Measure||!m[0].Measure.PropertyPath){jQuery.sap.log.error(s.errorMessages.CHART_ANNO_ERROR+"in "+s.errorMessages.CHART_ANNO+" "+s.errorMessages.MEASURES_MANDATORY);return r;}r=true;return r;};sap.ovp.cards.charts.SmartAnnotationManager.getEntitySet=function(e){return e.name;};sap.ovp.cards.charts.SmartAnnotationManager.getAnnotationQualifier=function(a){if(a&&a.indexOf("#")!=-1){var t=a.split("#");if(t.length>1){return t[1];}}return"";};sap.ovp.cards.charts.SmartAnnotationManager.buildSmartAttributes=function(s,c){function g(R,U,V){var W=U.split('.');var p=W.pop();var X=W.reduce(function(Y,Z){if(Y[Z]===undefined){Y[Z]={};}return Y[Z];},R);if(V){X[p]=V;}return X[p];}var C,e,a,b;var d,f,h,D,m,q,Q;var S;var r;var v;var k=[],l=[];var n=sap.ovp.cards.charts.SmartAnnotationManager;var o=s.getChart();d=o.getChartType();f=this.getConfig();for(var p in f){if((r=f[p].reference)&&f[r]){var t=jQuery.extend(true,{},f[r]);f[p]=t;}if(f[p].default.type==d||(f[p].time&&f[p].time.type==d)){h=f[p];break;}}if(!h){jQuery.sap.log.error(n.errorMessages.CARD_ERROR+"in "+n.errorMessages.CARD_CONFIG+n.errorMessages.CARD_CONFIG_ERROR+d+" "+n.errorMessages.CARD_CONFIG_JSON);return;}if(!(C=s.getModel('ovpCardProperties'))){jQuery.sap.log.error(n.errorMessages.CARD_ERROR+"in "+n.errorMessages.CARD_CONFIG+n.errorMessages.NO_CARD_MODEL);return;}var u=s.getModel();var w=C.getProperty("/entitySet");if(!u||!w){return;}e=C.getProperty("/entityType");if(!e){jQuery.sap.log.error(n.errorMessages.CARD_ANNO_ERROR+"in "+n.errorMessages.CARD_ANNO);return;}var M=n.getMetadata(u,w);a=C.getProperty("/chartAnnotationPath");if(!a||!(b=e[a])){jQuery.sap.log.error(n.errorMessages.CARD_ANNO_ERROR+"in "+n.errorMessages.CARD_ANNO);return;}if(!(D=b.DimensionAttributes)||!D.length){jQuery.sap.log.error(n.errorMessages.CHART_ANNO_ERROR+"in "+n.errorMessages.CHART_ANNO+" "+n.errorMessages.DIMENSIONS_MANDATORY);return;}if(!(m=b.MeasureAttributes)||!m.length){jQuery.sap.log.error(n.errorMessages.CHART_ANNO_ERROR+"in "+n.errorMessages.CHART_ANNO+" "+n.errorMessages.MEASURES_MANDATORY);return;}Q=D.slice();q=m.slice();var x,y;for(var i=0;i<Q.length;i++){var z=Q[i];if(z&&z.Dimension&&z.Dimension.PropertyPath){x=z.Dimension.PropertyPath;if(M&&M[x]){if(M[x][n.constants.LABEL_KEY_V4]){y=M[x][n.constants.LABEL_KEY_V4].String?M[x][n.constants.LABEL_KEY_V4].String:M[x][n.constants.LABEL_KEY_V4].Path;}else if(M[x][n.constants.LABEL_KEY]){y=M[x][n.constants.LABEL_KEY];}else if(x){y=x;}l.push(y);}}}for(var j=0;j<q.length;j++){var A=q[j];if(A&&A.Measure&&A.Measure.PropertyPath){x=A.Measure.PropertyPath;if(M&&M[x]){if(M[x][n.constants.LABEL_KEY_V4]){y=M[x][n.constants.LABEL_KEY_V4].String?M[x][n.constants.LABEL_KEY_V4].String:M[x][n.constants.LABEL_KEY_V4].Path;}else if(M[x][n.constants.LABEL_KEY]){y=M[x][n.constants.LABEL_KEY];}else if(x){y=x;}k.push(y);}}}S=n.hasTimeSemantics(D,h,u,w);if(S){h=h.time;}else{h=h.default;}var E=false;var T=new sap.viz.ui5.controls.VizTooltip({formatString:'tooltipNoScaleFormatter'});T.connect(o.getVizUid());if(o){var B=o.getVizProperties();var H=true;if(h.properties&&h.properties.hasOwnProperty("hideLabel")&&!h.properties["hideLabel"]){H=false;}var F=false;if(d=='donut'){F=true;}if(B&&B.plotArea&&B.plotArea.dataLabel&&B.plotArea.dataLabel.visible){B.plotArea.dataLabel.visible=F;}B.title.visible=H?false:true;v={legend:{isScrollable:false},valueAxis:{title:{visible:H?false:true},label:{formatString:B.valueAxis.formatString}},categoryAxis:{title:{visible:H?false:true}},plotArea:{window:{start:'firstDataPoint',end:'lastDataPoint'},dataLabel:{visible:F,type:'value'}},interaction:{selectability:{legendSelection:false,axisLabelSelection:false,mode:'EXCLUSIVE',plotLassoSelection:false,plotStdSelection:true},zoom:{enablement:'disabled'}}};if(b.ChartType.EnumMember===sap.ovp.cards.charts.SmartAnnotationManager.constants.SCATTER_CHARTTYPE||b.ChartType.EnumMember===sap.ovp.cards.charts.SmartAnnotationManager.constants.BUBBLE_CHARTTYPE||b.ChartType.EnumMember===sap.ovp.cards.charts.SmartAnnotationManager.constants.LINE_CHARTTYPE){if(b&&b.AxisScaling&&b.AxisScaling.EnumMember){var G=b.AxisScaling.EnumMember.substring(b.AxisScaling.EnumMember.lastIndexOf('/')+1,b.AxisScaling.EnumMember.length);switch(G){case"AdjustToDataIncluding0":v.plotArea.adjustScale=false;break;case"AdjustToData":v.plotArea.adjustScale=true;break;case"MinMaxValues":var I=[];if(b["MeasureAttributes"][0]&&b["MeasureAttributes"][0].DataPoint&&b["MeasureAttributes"][0].DataPoint.AnnotationPath){var J=b["MeasureAttributes"][0].DataPoint.AnnotationPath;var K=J.substring(J.lastIndexOf('@')+1,J.length);if(e&&e[K]){var L=e[K];if(L&&L.MaximumValue&&L.MaximumValue.Decimal&&L.MinimumValue&&L.MinimumValue.Decimal){I.push({feed:"valueAxis",max:L.MaximumValue.Decimal,min:L.MinimumValue.Decimal});}else{jQuery.sap.log.error(n.errorMessages.ERROR_MISSING_AXISSCALES);}}}if(b.ChartType.EnumMember!==sap.ovp.cards.charts.SmartAnnotationManager.constants.LINE_CHARTTYPE&&b["MeasureAttributes"][1]&&b["MeasureAttributes"][1].DataPoint&&b["MeasureAttributes"][1].DataPoint.AnnotationPath){var J=b["MeasureAttributes"][1].DataPoint.AnnotationPath;var K=J.substring(J.lastIndexOf('@')+1,J.length);if(e&&e[K]){var L=e[K];if(L&&L.MaximumValue&&L.MaximumValue.Decimal&&L.MinimumValue&&L.MinimumValue.Decimal){I.push({feed:"valueAxis2",max:L.MaximumValue.Decimal,min:L.MinimumValue.Decimal});}else{jQuery.sap.log.error(n.errorMessages.ERROR_MISSING_AXISSCALES);}}}o.setVizScales(I);break;default:break;}}}var N=C.getProperty('/ChartProperties');if(h.hasOwnProperty('vizProperties')){var O=h.vizProperties;for(var i=0;i<O.length;i++){if(N&&O[i].hasOwnProperty('path')){var P=g(N,O[i].path);if(undefined!==P){g(v,O[i].path,P);}}}}o.setVizProperties(v);}[h.dimensions,h.measures].forEach(function(R,i){var U=i?m:D;var V=i?"measure(s)":"dimension(s)";if(R.min&&U.length<R.min){jQuery.sap.log.error(n.errorMessages.CARD_ERROR+"in "+d+" "+n.errorMessages.CARD_LEAST+R.min+" "+V);E=true;}if(R.max&&U.length>R.max){jQuery.sap.log.error(n.errorMessages.CARD_ERROR+"in "+d+n.errorMessages.CARD_MOST+R.max+" "+V);E=true;}});if(E){return;}sap.ovp.cards.charts.SmartAnnotationManager.setSmartFormattedChartTitle(k,l,s);if(s){if(s._headerText){s._headerText.setTooltip(s.getHeader());s._headerText.addStyleClass("ovpChartTitle");}}};sap.ovp.cards.charts.SmartAnnotationManager.setFormattedChartTitle=function(m,d,c){var t="",a="",b="";if(c){t=c.getText();}if(m&&(m.length>1)){for(var i=0;i<m.length-1;i++){if(a!=""){a+=", ";}a+=m[i];}a=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("MEAS_DIM_TITLE",[a,m[i]]);}else if(m){a=m[0];}if(d&&(d.length>1)){for(var i=0;i<d.length-1;i++){if(b!=""){b+=", ";}b+=d[i];}b=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("MEAS_DIM_TITLE",[b,d[i]]);}else if(d){b=d[0];}if(c&&(t=="")){t=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("NO_CHART_TITLE",[a,b]);c.setText(t);c.data("aria-label",t,true);}};sap.ovp.cards.charts.SmartAnnotationManager.onDataReceived=function(v,c,d){var a=d?d.getParameter('data'):null;var l=(a&&a.results)?a.results.length:0;var t=a?a.__count:0;var b=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("Count_Header",[l,t]);c.setText(b);c.data("aria-label",b,true);};sap.ovp.cards.charts.SmartAnnotationManager.setCustomTitle=function(c,m,d){var t=c?c.String:"";return t;};sap.ovp.cards.charts.SmartAnnotationManager.setChartScaleTitleNew=function(v,a,f,c,t){var C,e,b,d;var M;var s=sap.ovp.cards.charts.SmartAnnotationManager;var u=s.constants.UNIT_KEY;var g=s.constants.UNIT_KEY_V4_ISOCurrency;var h=s.constants.UNIT_KEY_V4_Unit;if(v.getVizType()==='donut'){return;}if(!(C=v.getModel('ovpCardProperties'))){jQuery.sap.log.error(s.errorMessages.CARD_ERROR+"in "+s.errorMessages.CARD_CONFIG+s.errorMessages.NO_CARD_MODEL);return;}var k=v.getModel();var l=C.getProperty("/entitySet");if(!k||!l){return;}e=C.getProperty("/entityType");if(!e){jQuery.sap.log.error(s.errorMessages.CARD_ANNO_ERROR+"in "+s.errorMessages.CARD_ANNO);return;}var o=s.getMetadata(k,l);b=C.getProperty("/chartAnnotationPath");if(!b||!(d=e[b])){jQuery.sap.log.error(s.errorMessages.CARD_ANNO_ERROR+"in "+s.errorMessages.CARD_ANNO);return;}if(!(M=d.MeasureAttributes)||!M.length){jQuery.sap.log.error(s.errorMessages.CHART_ANNO_ERROR+"in "+s.errorMessages.CHART_ANNO+" "+s.errorMessages.MEASURES_MANDATORY);return;}var r=a?a.results:null;var p,n="",q=[];var w=true;var x=true;var y=[];var z=v.getFeeds();jQuery.each(z,function(i,j){if(j.getType()==="Measure"){y=y.concat(j.getValues());}});var A="";jQuery.each(f,function(i,j){if(A===""){A=j.scale;}if(A!=j.scale&&(i!="bubbleWidth")){x=false;return false;}});if(r){jQuery.each(M,function(i,m){var j="";p=m.Measure.PropertyPath;if(o&&o[p]){if(o[p][s.constants.LABEL_KEY_V4]){j=o[p][s.constants.LABEL_KEY_V4].String?o[p][s.constants.LABEL_KEY_V4].String:o[p][s.constants.LABEL_KEY_V4].Path;}else if(o[p][s.constants.LABEL_KEY]){j=o[p][s.constants.LABEL_KEY];}else if(p){j=p;}}if(jQuery.inArray(j,y)!=-1){if(o&&o[p]){var D;if(o[p][g]){D=o[p][g].Path?o[p][g].Path:o[p][g].String;}else if(o[p][h]){D=o[p][h].Path?o[p][h].Path:o[p][h].String;}else if(o[p][u]){D=o[p][u];}if(D&&o[D]){for(var i=0;i<r.length;i++){var E=r[i];if(w){if(n&&E[D]&&(E[D]!="")&&(n!="")&&(n!=E[D])){w=false;}}n=E[D];if(n&&n!=""){var F={};F.name=j;F.value=n;q.push(F);break;}}}}}});}var V=v.getVizProperties();var B=c.data("chartTitle");if(w&&x){if(isNaN(Number(A))&&A!=undefined){if(n!=""){B=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN",[B,A,n]);}else{B=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN_NO_SCALE",[B,A]);}}else if(n!=""){B=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("IN_NO_SCALE",[B,n]);}if(c){c.setText(B);c.data("aria-label",B,true);}v.setVizProperties(V);}else if(!w||!x){jQuery.each(V,function(i,m){var D=i;jQuery.each(f,function(j,E){if(D===j){if(m&&m.title){var F=E.measNames.join(" & ");for(var i=0;i<q.length;i++){if(q[i].name===F){var G="";if(isNaN(Number(E.scale))&&E.scale!=undefined){if(n!=""){G=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE",[F,E.scale,q[i].value]);}else{G=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE_NO_SCALE",[E.scale]);}}else if(n!=""){G=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("AXES_TITLE_NO_SCALE",[F,q[i].value]);}m.title={text:G};}}}}});});v.setVizProperties(V);}};sap.ovp.cards.charts.SmartAnnotationManager.getSapLabel=function(m,M){var a;jQuery.each(M,function(i,v){if(v.name==m){if(v["com.sap.vocabularies.Common.v1.Label"]){a=v["com.sap.vocabularies.Common.v1.Label"].String?v["com.sap.vocabularies.Common.v1.Label"].String:v["com.sap.vocabularies.Common.v1.Label"].Path;}else if(v["sap:label"]){a=v["sap:label"];}return false;}});return a;};sap.ovp.cards.charts.SmartAnnotationManager.formatByType=function(m,p,v){var s=sap.ovp.cards.charts.SmartAnnotationManager;var t=s.constants.TYPE_KEY;if(!m||!m[p]||!m[p][t]){return v;}var n=["Edm.Int","Edmt.Int16","Edm.Int32","Edm.Int64","Edm.Decimal"];var c=m[p][t];if(jQuery.inArray(c,n)!==-1){return Number(v);}return v;};sap.ovp.cards.charts.SmartAnnotationManager.getMaxItems=function(s){var c=s.getModel('ovpCardProperties'),e=c.getProperty("/entityType"),p=c.getProperty("/presentationAnnotationPath"),a=e.hasOwnProperty(p)&&e[p],m=a&&a.MaxItems;if(m){return{itemsLength:+(m.Int32?m.Int32:m.Int),dataStep:+c.getProperty("/dataStep")};}};sap.ovp.cards.charts.SmartAnnotationManager.attachDataReceived=function(s,c){s.attachDataReceived(function(e){var a=sap.ovp.cards.charts.SmartAnnotationManager;var b=s.getHeader();var d=s._getVizFrame();var f=c.getView().byId("bubbleText");var g=sap.ui.getCore().getLibraryResourceBundle("sap.ovp").getText("BUBBLESIZE");if(d){if(f!=undefined){var h=d.getFeeds();jQuery.each(h,function(i,v){if(h[i].getUid()=="bubbleWidth"){var j=c.getEntitySet()&&c.getEntitySet().name;var k=d.getModel();var m=a.getMetadata(k,j);var l=h[i].getValues()&&h[i].getValues()[0]&&h[i].getValues()[0].getName();var n=a.getSapLabel(l,m);f.setText(g+" "+n);}});}}sap.ovp.cards.charts.SmartAnnotationManager.buildSmartAttributes(s,b);});};}());
